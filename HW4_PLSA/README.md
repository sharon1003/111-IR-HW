# Homework 4 - PLSA

## 使用的 tool
Python, nltk, tqdm, re

## 資料前處理

使用stopword, lemmatization，以及正規表達式，將一些特殊符號或數字刪除。

## 模型參數調整

* 參數設定：
    * `K` = `8` / `alpha` = `0.33` / `beta` = `0.33` / `epoch` = `50`


## 程式流程

1) 初始化兩個矩陣，`P(W|T)`, `P(T|D)`
2) 先建立出Background Language Model，最後在處理query的部分會比較快速。
3) EM 這部分的算法，主要從M step 的角度出發，當需要使用到E step 的參數時，
則呼叫E step function，並透過傳遞參數來即時做計算。好處是不用另外在建立一
個二維陣列，缺點則是比較消耗時間。
4) 計算query時，也沒有使用到老師所說的np.logaddexp() method，因為之前
在測試時，有可能是我自己不太會使用這個method，導致計算時容易出錯，無法
計算出document之間的差別，因此後來直接帶入原本的公式，也獲得不錯的結果。

## 個人心得

這次的作業，從了解PLSA到程式實作出來大概花了十天的時間，最一開始的問題是想
說要如何減少p(T | W, D)的大小，經由老師一個禮拜後的講解，知道可以不必一次把
E step 算完再去M step，而是可以邊算邊更新。第二個問題，則是程式速度太慢，一
開始在跑程式的時候更新一次大概需要1個小時，但幸好在與同學討論的過程中，得知
道python可以用numba來做加速的動作，使用numba的缺點則是程式實作有一定的
限制。另外比較大的問題是使用log去做計算，後來發現不使用log也可以得到不錯的
效果，而且在計算速度上也更加快速。還好在最後兩天還是有如期地交出作業。
