author message topic search topic options post reply create new topic printable version translate topic charlie angel members profile send private message find members posts add to buddy list newbie joined 10 september 2007 status offline points 3post options post reply quote charlie angel report post thanks 0 quote reply topic uninstalling using msiexec and psexec posted 10 september 2007 at 403am im trying to uninstall a product on a remote machine using psiexec and msiexec i have tried uninstalling the product on the machine locally usingmsiexecexe x drive path filenamemsi quietwhich is successful but when i try uninstalling it remotely using the following codepsexec  servername u username p password msiexecexe x drive path filenamemsi quiet i get the message this action is only valid for products that are currently installed msiexecexe exited on servername with error code 1605 the product is definitely installed before i try uninstalling it any ideas karlchen members profile send private message find members posts add to buddy list senior member joined 18 june 2005 location germany status offline points 5156post options post reply quote karlchen report post thanks 0 quote reply posted 10 september 2007 at 519am hi charlie there are tons of threads inside the pstools forum covering the topic psexec and uninstalling software remotely you just need to locate them using the forum search button using psexec msiexec as search string should revea� some of the threads eg you may also start here eg  25 ps exec remote installation  hth karl charlie angel members profile send private message find members posts add to buddy list newbie joined 10 september 2007 status offline points 3post options post reply quote charlie angel report post thanks 0 quote reply posted 17 september 2007 at 200am hi karl thanks for the reply but its not one of the more useful replies ive ever seen the link you pointed me to talks about remote installation not remote uninstallation and the search that you suggested i do brought up plenty of threads to do with installation but only one to do with uninstallation to this one thread to do with uninstallation you replied saying the same thing that you said to me and pointing me to the same link that doesnt deal with uninstallations hmmmmmmmsob hic choke karlchen members profile send private message find members posts add to buddy list senior member joined 18 june 2005 location germany status offline points 5156post options post reply quote karlchen report post thanks 0 quote reply posted 17 september 2007 at 449am hello charlie sorry to learn that you consider my answer not really helpful yet maybe you put too much stress on the terms installation vs uninstallation the problem which you experience is caused by msiexec   msi package on the one hand and by psexec on the other hand it is not really a question of whether you try use this combination to install or to uninstall a product it is the combination of msiexec   msi package and psexec that causes problems to quite a few users therefore i do not share your point of view that the reports about msiexec   msi package installations do not apply to your situation just because they are about installation and not about uninstallation the really nasty thing is that there seems to be no simple solution which applies to all situations and as your problem report is pretty vague and general it is hard to give any more precise pieces of advice kind regards karl edited by karlchen  17 september 2007 at 450am charlie angel members profile send private message find members posts add to buddy list newbie joined 10 september 2007 status offline points 3post options post reply quote charlie angel report post thanks 0 quote reply posted 17 september 2007 at 945am i dont really know how to reply to your reply  its working fine for installing the application but not for uninstalling it im not too sure how looking at answers to do a function i dont want to do will really help  without delving deep into workings of both tools to discover where the interaction is breaking down  which none of the forum answers really address what more would you like as a problem report is posting the code ive been using not enough karlchen members profile send private message find members posts add to buddy list senior member joined 18 june 2005 location germany status offline points 5156post options post reply quote karlchen report post thanks 0 quote reply posted 17 september 2007 at 1054am hello charlie just to avoid misunderstandings i am not trying to attack you in any way nor am i suggesting that you are doing anything in a wrong way the message i tried to get across was that the combination msiexec   msi package  psexec make a tricky couple is posting the code ive been�using not enough well posting the commandline and the error message is a good startpsexec  servername u username p password msiexecexe x drive path filenamemsi quiet this action is only valid for products that are currently installed msiexecexe exited on servername with error code 1605 yet apparently this information is not sufficient to give a really meaningful answerits working fine for installing the application this is an important piece of information reason it shows that in your environment you can use msiexec   msi package  psexec successfully the difference between installing and uninstalling is this there may be more differences during the installation process msiexecexe does not really need to find any information on the programme package in the registry or in the windirinstaller folder  unless this is an update installation during the uninstallation msiexecexe will definitely query both locations in order to determine which things need to be uninstalled and rolled back in which way the error message you receive suggests that msiexecexe when invoked remotely by psexecexe is not able to locate the installation information on the programme package you wish to uninstall this may have various reasons without knowing why msiexecexe fails to find the information it is looking for there may be no way of solving the issue you might use eg nirsoft my uninstaller locally on the the remote machine servername in order to find out where information about the programme package is stored perhaps this will give a hint which information might not be available to msiexecexe when invoked remotely by psexecexe factors which may also be of relevance are  the exact windows version used on the local machine  the exact windows version used on the remote machine servername  the exact psexec version used  the real name of the  msi programme package you are trying to uninstall hth kind regards karl   actually it might be a different folder as well karlchen members profile send private message find members posts add to buddy list senior member joined 18 june 2005 location germany status offline points 5156post options post reply quote karlchen report post thanks 0 quote reply posted 17 september 2007 at 1140am hello charlie just to give you any example of how complex  msi packages can be  and this may be even a simple example  nirsoft my uninstaller told me that the ms powertoy command prompt here had the regkey 6855ccddbdf948e4b80a80dfb96fe36c using this value as a search string inside reg edit i ended up here hklmsoftwareclassesinstallerproductsddcc55869fdb4e848ba008fd9bf63ec6 the clsid 6855ccddbdf948e4b80a80dfb96fe36c is just part of the value product icon the more important value is the product code ddcc55869fdb4e848ba008fd9bf63ec6 this product code will be found below hklmsoftwareclassesinstaller inside the registry subtrees features products and upgrade codes the clsid 6855ccddbdf948e4b80a80dfb96fe36c will also be found here hklmsoftwaremicrosoftwindowscurrent versionuninstall  this will be the location which msiexecexe will definitely query should i ever choose to uninstall cmd here this location holds the path to the original installation package as well as the uninstallation command which msiexecexe should run i think it may be helpful if you locate the corresponding registry locations for the product package you wish to uninstall also check the folder where the original  msi file should be located value  installsource  if it is located on a network drive then a remote msiexecexe session may not have access to it the name of the original installation package will  in my exampe  be found here hklmsoftwareclassesinstallerproductsddcc55869fdb4e848ba008fd9bf63ec6source listpackage name hth karl edited by karlchen  17 september 2007 at 1141am 