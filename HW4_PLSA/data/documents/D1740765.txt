announcement question and answer thanks for the question douglas asked june 18 2012  1019 am utcanswered by tom kyte  last updated september 09 2013  1114 am utccategory database  version 11202viewed 10k times this question is whilst you are here check out some content from the ask tom team quick tipdatabase link passwords latest followup you asked im a little confused about why i would want to use asm supposing i have a san storage system where everything is already raid 10 anyway wouldnt i forego using asm in such a situationand we said not really asm is about managing database storage in the best way possible for the database it is not just about mirroring  it is about storage management if you have external redundancy  that is all well and good dont use asm mirroring but then do use asm to set up all of your storage for the database just get devices from the storage team not mount points and set up your storage for your databases as you see fit rather than the typical one size fits all way of allocating disk you might otherwise get from the storage team if you are using rac then asm in my opinion is mandatory if you are just a bunch of files and you dont care too much  then using a regular old file system is ok but if you want to know how the storage is being used  where redo is going and who else is using that device for example  then asm is where you want to beand you rated our response 24 ratingsis this answer out of date if it is please let us know via a review reviews asmjune 18 2012  527 pm utcreviewer a readerjust get devices from the storage team not mount points and set up your storage for your databases as you see fit what is the difference here are devices actual separate physical devices while mount points could be logical or physical ie 10 mount points on one single disk if you are just a bunch of files and you dont care too much  then using a regular old file system is ok what do you mean here are not all databases just a bunch of data control and redo log files if you use asm dont you have to tell the san or storage guys to turn off theur own disk volume manager followup june 18 2012  609 pm utcsam mount points are whatever the storage people make them to be perhaps you are striped onto the same disks that are running your exchange servers devices are yours if you are just a bunch of files and you dont care too much  then using a regular old file system is ok if you dont care too much if you dont care too much about performance if ok pretty good is good enough how those bunches of data files control files and redo log files are located makes a difference  if you care not everyone has to care seriously some just need pretty goodasm june 20 2012  632 pm utcreviewer a reader tom so for our 11g databases we should ask for our own dedicated storage devices and not just mount points that could be shared with other applications right if you use asm dont you tell your san or storage peeople to turn off their own volume manager or not install filesystem or something versus not using asm for a small db 50 gb how many physical disks you request for your oeprational files area and backup area i assume you need at least two physical disks with separate power and controllers i noticed asm creates another oracle instance for each database instance and it has to talk to the application instance and if it is down the whole system is down so we have to adminster the asm instance too followup june 21 2012  606 pm utcsam if you want to use asm you want devices not file systems correct for a small db 50 gb how many physical disks you request for your oeprational files area and backup area depends size doesnt tell anyone anything useful here what are your uptimerecovery time requirements if you have none who cares if you have high ones  then you might need more  and you might even need a failover site you only run an asm instance once on a machine and that instance can service many databases and you have to administer file system services too so i am not sure what your point wasasm june 22 2012  336 pm utcreviewer a reader tom ok great information for friday on storage it sounds asm is asm  os filesystem  os volume manager so it is either dba does it with asm or systems admin if using os so we ask for raw devices depends size doesnt tell anyone anything useful here what are your uptimerecovery time requirements  my goal is 24x7 uptime  but they can afford 2 days of downtime until bring system back also i want point in time recovery to bring them back to point when system crashed so now would you ask for two raw devices one for operational files and one for backups cant you show a simple physical storage configuration on how many disks you would like to have and where you would install oracle server data files control files redo log files etc and all the other backup files we also want to multiplex redo log files and control files to the backup area too real time in case the disk for operational stuff goes bad i assume the 3rd layer of storage would for raid disks which would mirror the operational disks followup june 22 2012  505 pm utc24x7 but we can be down for two days sam  you always say the funniest things you have no real uptime requirements then this is a boring system you probably dont care what you are using anything will do you just need good backups and practice recovery with them for this system anything will be ok it isnt really that important day to day  you have no real 24x7 requirement do whatever you like  just have really solid backups that youve practiced recovery onasm june 22 2012  933 pm utcreviewer a reader tom 2 days downtime  boring system 24 x 7  exciting system forget my comment about the 2 day downtime let us say my reqt for the database is 24x7 uptime and point in time recovery how do you installsetup your oracle software data files and backups multiplexed files raid on physical disks followup june 23 2012  152 pm utcsam 2 days downtime implies 24x7 is a laughable dream you promote to make yourself feel more important i cannot forget something you said as fact in answer  with a lot more than 2 disks a lot more than 2 of anything youd have data guard in place at least 300500 miles apart youd be running rac on the production system at the very least youd have a lot more than two disks youd have at least two nics and so on and so on and so on rac and asm june 26 2012  148 pm utcreviewer a reader hello tom can you please share details behind your opinion of using asm mandatory in case of rac deployment as suggested in your first answer cheers rod followup june 26 2012  303 pm utcyou need a clustered filesystem for rac you have to have one asm comes with the database asm provides a clustered file system asm was built specifically to do this anything else would be an additional cost 3rd party product that you would have to integrate and get working with rac rac and asm june 26 2012  149 pm utcreviewer a reader hello tom can you please share details behind your opinion of using asm mandatory in case of rac deployment as suggested in your first answer cheers rod rac and asm june 26 2012  324 pm utcreviewer a reader thanks device vs lunjune 27 2012  418 am utcreviewer claus from denmark i know im being a bit picky here around terminology but i miss a clarification  but if you want to know how the storage is being used  where redo is going and who else is using that device for example  then asm is where you want to be oracle asm does a lot for you and have some significant extra features compared to other volume managers but it cant tell you who else is using a device asm will own a lun or a partition which may or may not origin from a storage device or pool fully dedicated to oracle other luns could have been carved from the same device and used for completely unrelated activity such as file systems asm would not know followup june 27 2012  937 am utcyes you would want a dedicated luns  of all of the underlying resources are just dedicated to you if you are using them shared resources inside the sanjune 27 2012  834 pm utcreviewer david penington i fully agree with wanting dedicated hardware inside the san dedicated disksluns some things cant be dedicated and impact performance a war story i recently had terrible performance on a server during the evenings a dedicated backup server was collecting data from multiple servers and writing them to a san so fast that the san processor was the bottleneck our database genuine 24x7 process control had an operating system disk being serviced by that san processor the actual asm database disks had defaulted to the other processor in a redundant pair of san servers and the database instance performed terribly and could not keep up with the flow of events while the other rac node ran fine because the san server could not respond to its io requests on that operating system disk with an adequate response time it took months work out the cause so a beautiful backup server messed up the critical production system causing loss of control of physical equipment   you cant avoid san processor contention and its not supposed to happen but you can at least keep other systems off the databases disks to avoid their backupsbatch jobsspecial jobsunusual queries messing up the database and you being asked to work out why the  database isnt working properlyfollowup june 28 2012  929 am utcyou cannot imagine how many times ive heard the story of the database gets slow every night at timex what is wrong with the database it was always timex every evening hint it isnt the database ever it is always something else on the san if you are using rac then asm in my opinion is mandatory july 06 2012  840 am utcreviewer john cantu from texas tom what if the company has already purchased an enterprise san like netapps that will be used to host the databases plus all other applications the mount points are presented to the database server as nfs mount points cant be presented as raw now since rac can use nfs mount points for the shared filesystem would you still use asm i wouldnt think so since we would have redundancy with the netapps and asm software there would be two pieces of software to maintain two layers through which data has to go through bugs complexity double humanerror factor etc in addition netapps will have hardware striping while asm will have the slower performing software stripping do you believe that in this situation we can get some significant performance gains by throwing asm into the mix followup july 11 2012  835 am utcasm is not just about redundancy it is about ease of use for the dba adding devices removing devices moving data around in the database online and so on it is entirely up to you there is no double human error that i can see there is just human error you have more flexibility with asm software striping is not slow it doesnt really add any overhead we already have to figure out where to write regardless  asm or not how many disk and disk group  october 09 2012  317 pm utcreviewer mohanad awad from jordan hello can you please advice us tom on 1 how many disk group must be created 2 how many memeber must be cretead for reach disk group  3 is the size of each disk group must be equal and the member must be equal in size  4 what the best way and why  best regards mohanad awad followup october 10 2012  731 am utcthere is no single answer to this  for some people  one disk group is all they need for others  they want more so as to physically separate redo from data from temp the number of disks in a group depends on the redundancy level the amount of data you want to store and the size of your disks it would be best but is not mandatory if the disks were equal in size if there were a single best way there would only be one way  we would not have implemented inferior approaches if there was a single best way how many disk and disk group  october 13 2012  442 am utcreviewer mohanad awad from jordan  amman hello tom thanks for answer  just to make sure  1 about how many disk group  can i create disk group for data this is the first one and scond one for temp file and third one for logfiles  and so on or we can put all of them on one disk group 2 redundancy happen on disk groups level or  on dsik group memeber   3 disk group memeber can be different but this not good for performance  best regards mohanad awad followup october 13 2012  849 am utc1 yes to both you can create one disk group for all you can create one disk group for each 2 redundancy is within a disk group the stripes will be mirrored within the group every member can contain primary and secondary and tertiary stripes 3 it is possible but not recommended you want disks of similar performance and similar size httpdocsoraclecomcdb1930601server102b14231storemanhtmsthref1693stripes and mirrored october 13 2012  931 am utcreviewer mohanad awad from jordan  amman dear really thanks so much  very nice answer and very clear  my last q is about asm is stripes  mirrored i am so confuse abut the different  1 lets say we have three asm memeber in x diskgroup  so the data with strip first time to one of them then asm instance will mirrored the data to other tow memeber  2  let say the mirror type is normal so in above case we have tow copy of data in same disk memeber so it will be like this  afirst disk member will have 2 copy bsecond disk member will have 2 copy cthird disk member will also have 2 copy  or the mirror will be 2 copy just in all three disk memeber and the size so will be different in one of them  3 how the stripes will make io more faster  regards mohanad awad followup october 15 2012  825 am utcfor mirroring  you would set up failure groups  3 would be a bad number you want the failure groups to be the same size  for mirroring and all unless you went high redundancy triple mirroring basically  well stripe the data write a bit here write a bit there write some more over here and so on and ensure they are mirrored across failure groups striping doesnt make the io faster against any single disk it simply helps ensure that io will take place evenly across all of your devices  so you dont end up with any single hot disk taking the brunt of the io requests  the io requests will be spread out over all of the devices evenlymirroring disg group or in disk group filare october 15 2012  414 pm utcreviewer mohanad awad from jordan  amman dear thanks  1 dose the mirroring happen within in disk group or disk failure groups  2 is there any query to show every datafile or extend to which disk group member belong  followup october 16 2012  924 am utcmirroring is across failure groups the mapping of extents to diskgroups is the same as the mapping to files in the filesystem just query dbadatafiles and dbaextents as you would for a file asm looks and feels just like a file system inside the databaseuse external redundancy  not asm mirroring december 17 2012  1039 pm utcreviewer duc from houston txhi tom would you elaborate further on your comments use external redundancynot asm mirror your reply to the very first question of this thread what are the pros and cons of asm mirroring vs external redundancy would this mirroring significantly impact io performance of the san thank you followup december 18 2012  1250 pm utcthey said they have a san that is already doing redundancy  so they didnt need the redundancy part of asm if they had a san that didnt do that they would want to use asm to do the redundancy that is all wed rather have asm do the redundancy  but if the software in the san is already doing that and we cannot turn it off  go ahead and use it but use asm still just because it isnt doing the mirroring doesnt mean you shouldnt use it what the benefit of member of disk group asm january 29 2013  325 pm utcreviewer mohanad awad from jordan hello back with q  if i have diskgroup name data  it has 4 disk member  usrsbinoracleasm listdisks disk1 disk2 disk3 disk4  i use all of them for data diskgroup and i use new asm diskgroup fra with 3 memeber disk5 disk6 disk7  my question is what the benefit of connect data disk group with 4 disk member and fra with 3 member  1  why we did not use just one for each disk group 2  what the benefit of members dose more member make more performance  3 why did not use 100 200  disk group member  what the best number of member of each disk group  what is procedure  regards mohanad awad followup january 31 2013  931 am utcyoull want to read about raid and striping of data in general typically the more devices the more resources the better we can read and write as there would be more things that can be done in tandem no hot disks  nice even io patterns across many devices 1 because you had multiple devices and wanted four of them to be for data and three of them to be for the fast recovery area if you used one disk  none of the disk groups would be large enough 2 see above comment 3 presumably because you dont have 100 or 200 disks sitting around  your needs are not large enough to justify 100  200 disks what is procedure a mixture of experience education mentoring reading testing  and time lots of time asm size february 01 2013  738 am utcreviewer mohanad awad thanks for answer  just to make sure  1 disk group memeber on disk group mean  physical hardisk for example  on one hard disk formated and divided into diffrent size  2 if i have as above example 4 member disk for disk group data  the size will be the total of them and the same of extent will be divided into 4 part  all extent is the same or accumulative 3 so more disk member of more disk group will make more performance and more fast  followup february 01 2013  225 pm utc1 disk group members are devices that might be a partition on a single disk it wouldnt make sense to partition the disk into more than one partition and then give them all to us  wed think we were striping over multiple disks but we wouldnt be that might be a striped volume made up of many disks and so on it is a device to us like a raw disk 2 i dont know where extent came from  but if you create a disk group with four members  yes the size will  sum member and data will be striped across them 3 depends in general  yes but if you do something nonsensical like partitioning a single disk into four partitions and giving us four members  no it wouldnt do anything for performance february 02 2013  255 pm utcreviewer mohanad awad thanks  very useful answer regards mohanad awad asm san and the rebalancing act april 18 2013  207 am utcreviewer ron from chicago ili have been knee deep in troubleshooting of a sanwide performance problem that appears to be linked to sanlevel replication of an asm instance since we are using async replication it is difficult to determine what is assassinating our storage processors having said this i am attempting to disprove that sudden spikes in the volume of data changed is due to rebalancing operations between logical disks within the disk group this brings me to my question with a san environment where we have dedicated disk pools and raid groups with 15 disks why would we use asm striping it seems to me that it would be more prudent to increase the number of disks within the poolraid group rather than having multiple logical disks in the asm disk group with a separate dedicated disk poolraid group it seems that would prevent the rebalancing overhead while achieving a similar level of performance followup april 22 2013  742 pm utc why would we use asm striping  because you cannot disable it asm always stripes period it doesnt have to mirror but itll always stripe but why does that matter here striping isnt going to kill storage processors if you take 15 disks and present them to us as a single disk  well have one disk to stripe against  meaning effectively we really wont be striping you know that asm doesnt rebalance unless you addremove storage right what rebalancing are you talking about asm sandbox may 02 2013  218 pm utcreviewer andre from france hi tom i am considering to build an asm sandbox to practice various operations setups etc before the asm can be implemented for real  ie management agreement  po etc  then san devices allocated etc i have a samsung laptop running oracle linux 57 with oracle 11g r2 on a single 160mb drive the other bay holds a drive with win7 os but i can buy a new drive and replace the win7 with do you know if it would be easy task to add a new device and make the existing oracle linux recognize it as a raw device which asm would later be able to use i do not want to lose the existing linuxoracle setup or go through the entire reinstallation all over again thank you in advance andre asm practice june 12 2013  916 am utcreviewer andre from france dear tom i am aware that you are not checking every thread on your site at all times  just hoping you may spot this  as my repeated request for advice  see above i had some exposure to asm on the previous project  however all had been already setup and all i could do was to make a few queries i have read the docs  but nothing can substitute for handson testpractice have you checked asm on a small setup and may offer advice my laptop can handle this with an addition of one disk second disk bay thanks andre followup june 18 2013  304 pm utci dont know  im not a system admin type id have to ask someone else for help doing the same on my own machine  this is more of a linux question then a database question it should be relatively easy to get linux to recognize another disk yes asm rebalancing june 20 2013  159 am utcreviewer rahul from india dear tom thanks for your knowledge sharing i have a doubt about rebalancing scenarios eg create diskgroup data normal redundancy failgroup controller1 disk devicesdiska1 name diska1 devicesdiska2 name diska2 devicesdiska3 name diska3 devicesdiska4 name diska4 failgroup controller2 disk devicesdiskb1 name diskb1 devicesdiskb2 name diskb2 devicesdiskb3 name diskb3 devicesdiskb4 name diskb4  now if something goes wrong and all of sudden diska1 from controller1 is dropped even without rebalancing i mean to say something goes terribly wrong and asm does not get a chance to do the rebalancing for diska1 now how data will be read and written to the data diskgroup as disk is missing from primary failgroup as per my understanding asm can read the data from secondary failgroup if primary is not available but how it will manage to write kindly explain the read and write both scenarios here that how asm will handle this situation thanks a lot primary and secondary extents allocation june 21 2013  551 am utcreviewer rahul from india eg create diskgroup data normal redundancy failgroup controller1 disk devicesdiska1 name diska1 devicesdiska2 name diska2 devicesdiska3 name diska3 devicesdiska4 name diska4 failgroup controller2 disk devicesdiskb1 name diskb1 devicesdiskb2 name diskb2 devicesdiskb3 name diskb3 devicesdiskb4 name diskb4  as per oracle documentation when a block is written to a file each extent in the extent set is written in parallel it means primary and secondary extents are written paralelly at the same time now in above scenario how asm decides to write the primary extent and secondary extent is it always the case that asm will consider the controller 1 as primary failgroup and write the primary extents into controller1 disks how asm chooses where to write primary extents and where to write secondary extents what is the logic behind this selection please explain thanks followup july 01 2013  356 pm utchttpdocsoraclecomcdb2835901server111b31107asmdiskgrpshtmchddbhch a failgroup can have primary and secondary extents from things in it  each failgroup is as good as any other failgroup it just looks to distribute the readwrite io over all of the available disks the detailed logic behind this isnt documented  it just mirrors and stripes everything over all of the available disks asm intelligent data placement and sanseptember 05 2013  502 pm utcreviewer romit from india hi tom will asm intelligent data placement work with san storage is there are any scenario where this feature of asm will not work with san storage thanks romit followup september 09 2013  1114 am utcyou need be giving asm disk if you san gives it disk not groups of disk  sure 