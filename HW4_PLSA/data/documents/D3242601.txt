c header control sergeivp 20 jun 2004480 15 votesrate this vote 1 vote 2 vote 3 vote 4 vote 5 net wrapper of the system header control download source files  338 kb download binary files  278 kb introduction windows provides developers with many useful controls many of us just got into the habit to build gui with those controls relying on that they are available on various versions of windows and development environments but not all windows common controls or their wrappers are shipped with  net framework once i needed header control for a windows forms application but just could not find it so i had to implement a  net wrapper myself and now can share it with you unfortunately i did not have enough time to provide support for all available features of standard header control so ive implemented just common things used most often actually i just did not implement owner draw and filters so for those who need to use header control in  net windows forms applications here it is overview ive made the controls api similar to other  net framework controls so if you have used them before it would be easy to learn this one it has a collection of sections corresponding to win api header control items and events being fired according to notifications styles of control window can be changed by corresponding properties designtime support is also provided so you can install this control in your toolbox and use it in the form designer to make it in vs net click toolscustomize toolbox or in vs 2003 from toolbox context menu select addremove items in appeared dialog box activate  net framework components tab then click browse button and open sp headerdll file also ive made a simple application to demonstrate and test the controls features control classes here is a short description of the main classes i dont have to write a long manual because you can learn it from the source code faster header section class represents header section or item it holds text image index bitmap and other attributes supported by windows header controls item the class is derived from component that makes it possible to edit the object at design time and it implements icloneable interface allowing creation of shallow copies of self instance properties header  gets a reference to the header control the section is attached to index  gets the location with the header controls header section collection of this section width  gets or sets the width of the section in pixels text  gets or sets the text displayed on the section image index  gets or sets the index to the image displayed on the section if no image should be displayed set this value to 1 bitmap  gets or sets additional bitmap to be displayed on the section right to left  gets or sets a value indicating whether text of the section is displayed from right to left content align  gets or sets the horizontal alignment of the text and images displayed on the section image align  gets or sets the alignment of displayed images according to the text on the section sort mark  gets or sets the sortmark to be displayed instead of bitmap on the section sortmarks are shown only when control is used with comctl32dll of version 60 shipped with microsoft windows xp or later constructorspublic header section public header section string text int cx widthpublic header section string text int cx width int i imagepublic header section string text int cx width object tagpublic header section string text int cx width int i image object tagpublic header section string text int cx width bitmap bitmappublic header section string text int cx width int i image bitmap bitmappublic header section string text int cx width int i image bitmap bitmap horizontal alignment en content alignpublic header section string text int cx width int i image bitmap bitmap horizontal alignment en content align left right alignment en image alignpublic header section string text int cx width int i image bitmap bitmap horizontal alignment en content align left right alignment en image align object tagpublic header section string text int cx width int i image bitmap bitmap right to left en right to left horizontal alignment en content align left right alignment en image align header section sort marks en sort mark object tagmethodspublic virtual object clone creates a shallow copy of the section header section collection class represents collection of the sections or items located in the header control to add delete and modify controls sections use this collection in contrast to the logic of win api header control all sections in the collection are kept in the order they are displayed you dont have to deal with indexes and orders like you do using win api messages it seems its just made to provide backward compatibility and could bring unnecessary confusions and bugs for  net developers so ive made it a little bit another way here you deal with header section objects and their collection the order of the section corresponds to its index in the collection so that win api header item index is not needed at all  it would be better to use handles instead of indexes like its done in list view properties header  gets a reference to the header control that owns the collection count  gets the number of elements in the collectionthis int index  gets or sets section in the collection section being set cannot be already attached to this or another header control methodspublic void insert int index header section iteminserts new section to the collection at specified position section being inserted cannot be already attached to this or another header controlpublic int add header section itemadds new section to the end of the collection section being added cannot be already attached to this or another header controlpublic void remove at int indexremoves section at specified position from the collectionpublic virtual void remove header section itemremoves given section from the collectionpublic void move int i from int i tomoves section from one position to anotherpublic void clear removes all sections from the collectionpublic int index of header section itemdefines index of given section in the collection or returns null if section is not found this index corresponds to the order of section it is displayed in the header controlpublic bool contains header section itemdefines if section is kept in the collectionpublic void copy to array a dest int indexcopies all elements to the array header class properties clickable  gets or sets clickable style if set to true section generates events when user clicks on hot track  gets or sets hot track style if set to true section is highlighted when mouse pointer is located on it flat  when set to true causes the header control to be drawn flat when microsoft windows xp is running in classic mode allow drag sections  determines if user will be able to drag header column on another position full drag sections  when set to true causes the header control to display column contents even while the user resizes a column sections  gets the collection of sections or items use this collection to add remove and modify sections of the header control image list  gets or sets an image list associated with header control images displayed on the sections are taken from this image list bitmap margin  width of the margin that surrounds a bitmap within an existing header control events section click  raised when user clicks on the section section dbl click  raised when user performs double click on the section divider dbl click  raised when user performs double click on the divider of the section before section track  raised when user is about to start resizing of the section the action can be canceled section tracking  raised when user is resizing the section the action can be canceled after section track  raised when user has the section resized before section drag  raised when user is about to start to drag the section on another position the action can be canceled after section drag  raised when user is dragging the section on another position methodspublic void begin update prevents the control from drawing until the end update method is calledpublic void end update resumes drawing of the control after drawing is suspended by the begin update methodpublic rectangle get section rect header section itemreturns a rectangule of the sectionpublic void calculate layout rectangle rect area out rectangle rect positionretrieves the correct size and position of a header control within the parent windowpublic int set hot divider int x int ypublic int set hot divider int i deviderchanges the color of a divider between header items to indicate the destination of an external draganddrop operationpublic hit test info hit test int x int ypublic hit test info hit test point pointtests a point to determine which header item if any is at the specified point conclusion enjoy known problems and bugs using visual studio net it is not possible to resize sections with mouse in design mode however it works fine in visual studio 2003 history06172004  release of version 100006242004  bugfix control was flickering when being resized in runtime mode license this article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves if in doubt please contact the author via the discussion board below a list of licenses authors might use can be found here sharetwitter facebooklinkedin reddit googleabout the author sergeivpweb developer ukraine no biography provided 