navigation welcome about uploading page list for siteall pages in sitegroups ly xtipsfaqtoolsla te xbib te xlayoutsmacwindowsexamplesglossary devel ly x documentation documentation manuals tutorials presentations ly x functions troubleshooting suggested reading official web site edit current page page list field sidebar sandbox group sidebar newshared groups sitetestprofilesplaygroundlinks site help site faqcopyrightswwwlyxorg pm wiki documentation view edit upload history print ly x tables categories table  page list  table formatting table of contents introduction vertical alignment of cell content multirows multiple lines in one table cell multicolumns dashed lines in tabular columns and rows colored tables customized table cell format81 formalstyle tables using booktabs82 selfdefined table cells83 extra height captions in longtables footnotes in tables101 table outside float102 table inside float importpaste into a table from excel or other spreadsheet link to an external spreadsheet file scaling tables decimal alignment of columns aligning text with images getting tables to automatically scale to a specific width numbering rows of a table introduction all things described in this wiki page and much more about tables and longtables is described in the embedded objects manual if you create a table ly x only asks for the number of columnsrows some table properties like the alignment can be adjusted in the table dialog that appears when you rightclick on a table but this dialog doesnt support all possibilities to format tables this page gives an overview about the missing table format options every section includes a small example ly xfile vertical alignment of cell content for fixedwidth columnsmulticolumn cells ly x lets you specify the vertical alignment top middle bottom however it is not at all intuitive how these settings are supposed to work and indeed the way this is done by the la te x package array is rather odd compared with what word processors usually do here are some explanations and solutions first some explanations even though the setting of the vertical alignment applies to the given column ie if you have a fixedwidth column you can only set one vertical alignment eg bottom for this whole column the alignment itself applies to the current row  the vertical alignment does not apply to the given cell in the sense that the content of this cell is then positioned vertically in the cell as specified this is what word processors usually do rather than that the settings have a visual effect on the remaining cells in the current row vertical alignment means here the current cell is aligned with respect to the baseline of the row ie if you have a cell with three lines in a column the vertical alignment middle will position this cell in such a way that the middle of this cell the second line in this case will be on the baseline with the other cells the effect is that it looks as if all others but this cell are middlealigned look below for examples of a middle top and bottomaligned threeline cell the baseline is what is highlighted yellow not precisely but maybe more intuitively you can also say that all the other cells in the row are positioned in the way you specifiy the vertical align of a multiline cell this means that the vertical alignment of a row should always be set in the cell which has the most lines because this one corresponds to the actual row height and any other multiline cells should be set to the default top  the rule that vertical alignment setting applies to the whole column does not apply for multicolumn cells this is important for some casesbmiddle aligned cellcbtop aligned cellcbbottom aligned cellc so much for theory now here are some scenarios1 suppose you want the following layoutmultiple linesbcdmultiple linesfghi to get the contents of the first row aligned in the middle you have to go to the first cell and specify vertical alignment middle however for the second row you will need to do this again in the second cell because this is the highest one in that row so again the vertical alignment of the contents in a row have to be set in the highest cell of that row no matter in what column this is2 now what if you want different alignments for different rows if the highest cell is in the same column consider this examplemultiple linesbcmultiple linesefghi the problem is that you have set vertical alignment middle in the first cell of the first row to get the content of the row vertically centered in relation to that row now you cannot set the vertical alignment to bottom to get the bottom alignment for the second row because the setting would also apply to the first row then remember it always applies for the whole column the solution is go to the first cell of the second row make it a multicolumn even though this multicolumn then has only one cell  specify the columns width for the multicolumn and then select vertical alignment bottom this setting will then only apply to the current row3 fine but can i also get a layout like this multiple linesbmultiple linesc sure look at the baseline you have to set the first multicolumn cell to top the second to bottom so i guess you got the idea now multirows example file tablemultirowlyx ly x supports multicolumns but no multirows so we have to use a bit ert at first we need to load the la te xpackage multirow in the preamble with the commandusepackage multirowmultirows are created with the commandmultirow number of rows cell width cell entryto create the following tableabcmultirow entryefhiwe create a 3 × 3 table to get rid of the line above the last cell in the first column we mark this cell as multicolumn in the table dialog and unset the upper border in the borders dialog the multirow is now created in the second row of the first column as we are using a la te xcommand switch to ert with the shortcut cl and type in the commandmultirow 2 25cm according to the command definition the multirow spans now two rows and has a width of 25 cm the text follows outside the ertbox and the command is finished with a right brace  in another ertbox at the end of the text at last we have to center the text because multirow leftaligns texts by default to override the default we renew the command multirowsetup with the preamble linerenewcommand multirowsetup centeringnow all entries of multirow cells in the document are centered if centering is only needed for several tables you can renew the command in an ertbox just before the table instead of the preamble line if you want to rightalign the text replace centering by raggedleft to return to leftalignment use raggedright  multiple lines in one table cell example file tablemultiplelineslyx adjusting a fixed width for a column enables to enter text as a paragraph with multiple lines and hyphenations we want to create the following tablemultiple linesbcdefghi we create a 3 × 3 table mark the first cell and rightclick on it in the appearing table dialog we adjust a cell width of 25 cm and choose centered for the vertical and horizontal alignment as our text is smaller than than 25 cm only one line will appear to get two lines we add a line break with the commandlinebreakin ert note that there must be no space between the last word where you want the line to break and the linebreak command now we want to center the text inside the two other cells of the first row vertically we rightclick in the second cell adjust a fixed width of 05 cm and choose centered alignments we do the same for the third cell of the row if we have a long word in a cell with a fixed width it cant be hyphenated by la te x if it is the first entry therefore we need to insert something to make the word not be the first entry we add the commandhspace 0ptin ert before the word as the space is zero it doesnt change the output multicolumns example file tablemulticolumnlyx ly x supports multicolumns directly but we have to take notice of the cell width of the columns spanned by the multicolumn cell we want to create for example this tablemultiple lines in a multicolumncdefghi we mark the first two cells in the first row of the 3 × 3 table and rightclick on them now we choose multicolumn centered alignment and a width of 25 cm the spanned columns should have exactly the half width of the multicolumn cell so that we would adjust a width of 125 cm for the first column the second column has then automatically a width of multicolumn width  width of first column but in the output we can see that is the first column has not the half width of the multicolumn cell the reason is that the given width w g is not the total width w tot of the cell the total width of n table cells w tot n can be calculated to w tot n n · w g n 2 · tabcolsep  n  1 · arrayrulewidth 1tabcolsep is the la te xlength between the cell text and the cell border its default value is 6 pt arrayrulewidth is the thickness of the cell border line the default is 04 pt the total width of a multicolumn w tot mult is w tot mult w g mult 2 · tabcolsep  2 · arrayrulewidth 2by setting equation 1 and 2 equal we can calculate the needed w g so that the column has a total width of w tot mult  nw g n  w g mult 1  n · 2 · tabcolsep  arrayrulewidth   n 3i our case we have n  2 w g mult  25 cm and the default values for the lengths so that equation 3 becomesw g 2 125 cm  62 pt 4to enable calculations in la te x we have to load the la te xpackage calc with the preamble lineusepackage calcly x does not allow to calculate lengths in the widthfield of the table dialog therefore we have to format the column by inserting a la te xargument in the dialog here is an overview about the argumentsp width creates cell with a fixed width its text is vertically topalignedm width creates cell with a fixed width its text is vertically centeredb width creates cell with a fixed width its text is vertically bottomaligned by entering a la te xargument we overwrite all cell properties adjusted in the table dialog ly x shows the old properties anyway but that is a bug as we want to center the text horizontally we add the command centering you can now use the following la te xargument for the first spanned column centeringm 125cm62ptthe bar  at the beginning draws the border line and the command    means that the commands inside the braces are applied before the cell is created although we have chosen centered alignment for the text of the multicolumn cell it is still left aligned this is the case because ly x applies the alignment only to single columns so we have to use for the multicolumn cell this la te xargument centeringm 25cmdashed lines in tabular columns and rows example file tabledashedlineslyx ly x doesnt natively support dashed lines so you have to use ert load the la te xpackage arydshln in the preamble with the commandusepackage arydshlnto make a vertical line dashed enter the colon together with the character for the horizontal alignment as la te xargument in the table cell dialog the table cell dialogue can be accessed by right clicking in that cell and going to more  settings or by placing your cursor in that cell and following the edit menu to table settings for example to make a centeraligned column have dashed lines on its right highlight the column and go to the table cell dialogue and enter c in the la te x argument box you will then probably need to select the column to the right and turn off the solid line on its left if you do not want both a dashed line on the left and a solid line on the right for a horizontal dashed line add the command hdashline in ert as first element of the first cell in the table row for multicolumn dashed lines use the command cdashline linenumber in ert as first element of the first cell in the table row if you have for example a multicolumn spanning over column 4 and 5 and you want to have it a dashed line above add the command cdashline 45 as first element of the first cell in the row of the multicolumn note the used la te xpackage arydshln is apparently not compatible with the la te xpackage colortbl used in the next section to produce colored tables that means that colored tables cannot have dashed lines colored tables example file tablecolorlyx to create colored tables we need the la te xpackage colortbl that is loaded in the preamble with the lineusepackage colortblthe color of a column is adjusted with the commandcolumncolor name of colorinside the command    the following color names are predefinedred green yellow blue cyan magenta black and white we also define our own color with the commanddefinecolor color name color model color valuesthe color model can becmyk c yan m agenta y ellow blac krgb r ed g reen b luegrayand the color values are comma separated numbers between 0 and 1 describing the factor for the corresponding color of the color model we can eg define the color darkgreen in the preamble with definecolor darkgreen cmyk 05 0 1 05and the color lightgray with definecolor lightgray gray 08as we want to color the first column with darkgreen we insert columncolor darkgreencenteringcas la te xargument for this column lines are colored with the commandrowcolor name of colorthat is inserted in the first cell of the line as ert cells are colored with the commandcellcolor name of colorthat is inserted at the beginning of the cell as ert to color the characters in the table mark the cells and use the ly x menu layout→character but if there is ert mark only the characters otherwise the colored ert will cause la te xerrors customized table cell format several la te x commands can be used to improve the format of a la tex table several examples are given below in some cases you can avoid using ert entirely by simply switching to the formal style which uses the la te x package booktabs internally example file tablecustomizationlyx formalstyle tables using booktabs the httpenwikibooksorgwikila te xtablesprofessionaltables booktabs package gives a professional look approve sites by not using vertical borders and by adjusting the spacing above and below the horizontal borders to enable the booktabs style rightclick the table and select settings under the borders tab in the style box select the formal bullet hover over the bullet to see a description use the formal aka booktabs border style no vertical borders in addition to not using vertical borders by default the booktabs style adjusts the horizontal border widths and the spacing to create a professionallooking table selfdefined table cells calculating the needed width for spanned columns like in the section multicolumn is very annoying if you have several tables with multicolumn cells to make life easier one can define a cellcolumn format in the preamble so that it can be used in all tables of the document the format is defined with the commandnewcolumntype name of format number af arguments commandsthe format name may only consist of one letter the letters b c l m p and r are predefinied and cant be used but all letters are allowed as capitals for multicolumn cells  we can definenewcolumntype m 1  centeringhspace 0ptm 1where hspace 0pt avoids the problem of hyphenating the first word as described in section multiple lines in one table cell with this we can simply enterm widthas la te xargument in the table dialog to have a centered multicolumn cell with a fixed width for cells spanned by a multicolumn cell  we can definenewcolumntype s 2  centeringhspace 0ptm  1 2tabcolseparrayrulewidth 122we can now enters width of multicolumn cell number of spanned columnsas la te xargument of the column this has the advantage that the needed width is automatically calculated with eqution 3 for colored columns  we can definenewcolumntype k 1  columncolor 1hspace 0ptcthe c creates a column with a flexible width whose text is horizontally centered we can now enter k color nameas la te xargument extra height large letters or those with a bigger height like b d etc often have not enough space between them and the upper cell border with the preamble linesetlength extrarowheight 2ptone can add 2 pt extra height although this often looks better it has the disadvantage that the cell texts are no more exactly vertically centered when math fractions are entered in a table sometimes there is not enough space between them and both the upper and lower cell border with the preamble linerenewcommandarraystretch 15the cells are stretched vertically creating sufficient room this preserves vertical centering captions in longtables new native solution a longtable cannot be put into a table float because floats can only be on one page however you can set caption for longtables which are not inside table float to do thisright click on table row  more  settings  longtable  caption on then after applying settings you can input caption into special box just like in table float old workaround solution example file tablelongtablecaptionlyx therefore ly xs caption layout cannot be used for longtables to add a caption for longtables a dirty hack is neededcaption short title full title123abcdef1 create a longtable2 mark the first row an disable its upper line3 insert the following command as ert into the first table cell caption short title full title4 insert a  as ert into every cell of the first row the caption command is used like for normal captions the short title that will appear in the lot instead of the full title is optional the  in the table cells omits the vertical line between the the cells the first table row is now only a dummy row for the caption the actual table starts with the second row footnotes in tables footnotes do not work in tables in ordinary tables that is  they do work in longtables the footnote number is printed but the text is omitted this is unfortunately a la te x restriction there are several ways to work around the problem though depending if your table is inside a float or not here is a selection of possibilities have a look at the tug faq for more information table outside float one way is to put in the preamble usepackage footnotemakesavenoteenv tabularanother is to put in the footnote footnotemark and outside just behind the table footnotetext  text of the footnote  both in ert note however that this method only works if you have just one footnote if you have more than one footnote the following trick helps put footnotemark commands inside the table where the footnote number should appear outside again just behind the table insert addtocounter footnote n where n is the number of footnotes you have just inserted into the table finally insert stepcounter footnotefootnotetext  footnote text  commands containing the texts of each footnote take care that you use the footnotemark and footnotetext commands in pairstable inside float this is more tricky since the float is floating and the footnotes are floating as well which makes it very difficult to handle footnotes the easieast way is to put the table in a minipage  insert→box  this will always give you footnotes but they are not part of the ordinary footnote apparatus but placed directly underneath the table and separately numbered note that the box minipage doesnt tolerate floats so that the table itself should be outside a float and in this case within the box this method can cause the table with footnotes to appear below any normal footnotes on the same page a solution is to add usepackage bottom footmisc to the preamble source httpskalkotoblogspotcom200801latexandfootnoteshtml approve sites  a float cannot be place in a box but a box can be placed inside a float footnotes work when placed in a table itself placed in a box itself placed in a float the packages threeparttable and ctable provide proper table notes which are also different from the normal footnotes the threeparttable package can be used with lyx tables and lyx tables floats by inserting begin threeparttable at the beginning of the lyx table float before the table caption and begin tablenotes item a the first note  end tablenotes end threeparttable at the end of the lyx table float the more powerful ctab package however can only be used in ert mode directly because the la te x table code looks different from standard la te x tables and is not yet supported natively by ly x if you really really need ordinary footnotes in a floating table which is not recommended you have to use the footnotemark  footnotetext method described above but place the footnotetext in the text next to the place where the float is put in the output note that this is highly fragile and you have to check everytime you exportview your document if the table placement and hence the footnote is still there importpaste into a table from excel or other spreadsheet see tips  link to an external spreadsheet file see this example this is linking not a copying technique changes to the spreadsheet will be reflected in ly x automatically scaling tables example file scalingtableslyx tables can be scaled scaling may be utilised when a table exceeds the paper width but there are other practical applications as well to scale a table in ly x create the table as usual make sure that the graphicx package is loaded in the preambleusepackage graphicxyou can then put the table in a resizebox in ert with the syntaxresizebox width height argumentwhere argument is in this case the table and width and height can be specified using any of the usual parameters like cm em pt and so on if you want to keep the aspect ratio of your table you can set as the height parameterresizebox textwidth  argumentas in the example file since the table the argument needs to be enclosed in braces  you need to enclose your table in two ert commands putresizebox width height before the table in ert and the closing braceafter it you can align scaled tables and they also work in a table float see the sample file for an example decimal alignment of columns section 2122 of the embedded objects manual manual discusses pros and cons of various ways to align column content around a character such as a decimal separator if the column will contain only decimal numbers the following approach should work fairly painlessly addusepackage dcolumnto the document preamble the dcolumn style is part of the required la te x tools package so you should have it installed rightclick in the column to be aligned navigate to the table settings tab and enter something like d   3 in the la te x argument field the three arguments are respectively the decimal separator used in the text as entered the decimal separator to be used in the output and the maximum number of decimal places the third argument can be negative in which case the column will be centered on the decimal separator with a positive argument the column will be right justified with the decimal separator aligned see the package documentation for more details aligning text with images consider a table consisting of images in some columns and labels or explanatory text in other columns the default vertical placement will align the baseline of the first line of text with the bottoms of the images in that row as illustrated belowlabel textimage  imageimage  imageorlabel textimage  imageimage  image one way to move the labels to the top of the row is to embed each image in a box either minipage or parbox in the vertical alignment portion of the box settings dialog leave the box position at top but change the content position to bottom this will result in the first line of label text aligning with inserted space just above the images as illustrated nextlabel textimage  imageimage  imageorlabel textimage  imageimage  image another approach is to leave the images alone no boxes and insert vertical space insert  formatting  vertical space spacing  custom and manually adjust the amount of space to obtain the desired effect this eliminates the vertical space above the images but may require some experimentation to achieve the desired positioninglabel text  vertical spacing   vertical spacing image  imageimage  imageorlabel text  vertical spacing image  imageimage  image getting tables to automatically scale to a specific width the tabularx la te x package provides tables that scale to a given width automatically ie you can define that specific columns are automatically stretched until the table reaches a predefined width ly x does not support the tabularx package natively yet but with the hack below you can redefine ly xs tables to tabularxs note however that this change applies to all tables in the document since all tables are treated as tabularxs of the predefined width put the following to document→settings→preamble  hack by heiko oberdiek on decomptexttex usepackage tabularx  redefine the standard table letorigtabulartabular letorigendtabularendtabular letorigtabularxtabularx renewcommand tabularx  deftabular  letendtabularorigendtabular origtabular  origtabularx  renewcommand tabular   the width of the table adjust if needed tabularx linewidth  renewcommand endtabular endtabularxin the tabular dialog you can define which columns should be expanded by adding the character x to the la te x argument input field in the tabular dialog for the respective column s alternatively to apply the hack to only specific tables in the document you can put only the 3 definitions and the redefinition of tabularx into the preamble and then use ert to redefine tabular and endtabular in a relevant table float before the tabular environment after the tabular environment use ert again to undo the changes ert block 1 before ly x tabular renewcommand tabular tabularx linewidth renewcommand endtabular endtabularx  put ly x tabular here  ert block 2 after ly x tabular renewcommand tabular origtabular renewcommand endtabular origendtabularnumbering rows of a table to number the rows of a table you can add the following to document→settings→preamble newcounter trow newcommand firstrow setcounter trow 1arabic trow newcommand nextrow addtocounter trow 1arabic trow in the table cell where you want the number of the first row insert firstrow in ert where you want subsequent row numbers insert nextrow in ert you can customize the presentation of the numbers by changing arabic to roman or roman and by changing the punctuation from a period to something else table 