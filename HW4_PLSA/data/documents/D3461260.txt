home forums  bukkit  plugin development disable and enable death messages using dm onoffdiscussion in  plugin development  started by rodney12345 mar 8 2013  thread status not open for further replies offlinerodney12345hey i have just finished all of the thenewboston beginner and intermediate tutorials so i am not that big of a java noob i just started today looking at the bukkit layout and getting familiar with it the more i play with it anyways i was thinking of creating some sort of plugin which disables and enables the death messages of minecraft using dm on to enable messages and dm off to disable or hide the messages what methods would i use thanks in advancerodney12345 mar 8 2013 1offline tirelessly my bukkit dev profile my plugins 1rodney12345 said â†‘anyone player death event set death message tirelessly mar 8 2013 2offlinekreashenz my bukkit dev profile my plugins 8you should create a permission or a command to turn onoff the event im not sure how to use perms to mess around with events so im not really sure just set up permissions i guess that would be the easiest way or you can set it enabled truefalse in a configkreashenz mar 8 2013 3offlinerodney12345ok something like this public void set death message  string death messagerodney12345 mar 8 2013 4offline real dope my bukkit dev profile my plugins 2code javalist  string  messages off  new array list  string   on command player p   player senderstring name  p get name if  messages off contains  name messages off remove  nameelse messages off add  name events outside of on commandevent handlerpublic void on death  player death event event string message  event get death message event set death message  nullfor  string s messages off player p  bukkit get server  get player  sp send message  messageevent handlerpublic void on leave  player quit event event if  messages off contains  event get player  get name  messages off remove  event get player  get name real dope mar 8 2013 5offline wolf7115my bukkit dev profile my plugins 2codeif death messages enabled  eventset death message null just put that in the player death event place you must also just set death messages enabled yourself but that parts easy codeif cmdget name equals ignore case dm  death messages enabled  death messages enabled this code when placed in the on command function will just toggly death messages without the use of an argument wolf7115 mar 8 2013 6offlinerodney12345thanks for the help you guys are the best so this is what i have so far anything i should adddelete codepublic class main extends java plugin  public final logger logger  loggerget logger minecraft public static main plugin public void on enable   plugin description file pdf file  thisget description  thisloggerinfo pdf fileget name    version   pdf fileget version    has been enabled   public void on disable   plugin description file pdf file  thisget description  thisloggerinfo pdf fileget name    version   pdf fileget version    has been disabled   liststring messages off  new array list string  public boolean on command command sender sender command cmd string command label string  args object death messages enabled  player p  player sender if command labelequals ignore case dm  psend message chat color gray  death messages has been toggled   string name  pget name  if messages offcontains name  messages offremove name  else  messages offadd name  return false  event handler public void on death player death event event  string message  eventget death message  eventset death message null for string s  messages off  player p  bukkitget server get player s psend message message   event handler public void on leave player quit event event  if messages offremove eventget player get name   messages offremove eventget player get name    anyone edit by moderator merged posts please use the edit button instead of double posting last edited by a moderator may 31 2016rodney12345 mar 9 2013 7offline minecrell my bukkit dev profile my plugins 4i think you should register your events minecrell mar 9 2013 8offlinekiwhen my bukkit dev profile my plugins 1there is actually quit a bit of code that doesnt make much sense in there public static main plugin is not used the logger is not used for anything useful method on disable  is not used for anything useful classes with event listeners must implement the listener interface as pointed out above event listeners must be registered using register events  there is an illegal cast to player in on command  sender may not be a player object at this point dont use the command alias to verify command names use commandget name  instead otherwise only the specified alias will work not the actual commandon command  takes four arguments command sender command string and string  if a class is only registered for one command a name check for commands is not needed as the method will not trigger on unregistered command callson command  should always return true when successful returning false will cause bukkit to send the player a message on how this command is used as specified in your pluginyml file messages off has no defined visibility packagewide visibility when its only ever used in the private scope player quit event attempts to remove a players name twice calling array listremove  on an element that is not present in the array will not cause any errors array listremove  returns true if an element was removed false otherwise this can be used to speed up the toggling in on command  by attempting to remove the element first and if this returns false add the element instead there is no null check present for p in player death event null pointer exception errors may occur bad practice tip eventlisteneres are usually named on plus the name of the event minus event player quit event should for instance be named on player quit and so on things like that makes it easier for others to read through your code tip send status messages after operations are complete in case the operation crashes if for some reason the toggling does not work the player will still receive a completion message ive made the adjustments below but i havent tested it yet these are mostly suggestions though codejavapublic class main extends java plugin implements listener public void on enable  get server  get plugin manager  register events  this thisprivate list  string  messages off  new array list  string  public boolean on command  command sender sender command cmd string alias string args if   sender instanceof player return trueplayer p   player senderstring name  p get name if  messages off remove  name messages off add  name p send message  chat color gray  death messages has been toggled return trueevent handlerpublic void on player death  player death event e string message  e get death message e set death message  nullfor  string s messages off player p  bukkit get server  get player  sif  p  null p send message  messageevent handlerpublic void on player leave  player quit event e messages off remove  e get player  get name kiwhen mar 9 2013 9 you must log in or sign up to reply here thread status not open for further replies share this page tweet home forums  bukkit  plugin development  