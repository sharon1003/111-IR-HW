home › endpoint security defending against the rising threat of nonmalware attacks by kevin townsend on december 22 2016tweet severe nonmalware attacks and ransomware are the two standout malicious behaviors of 2016 when combined as they have been with the power ware extortion the attack can be both dangerous and difficult to detect carbon black analyzed data from more than 1000 customers representing 25 million endpoints it found  pdf that nearly all organizations have been targeted by nonmalware attacks in 2016 and that in any 90day period about onethird of all organizations will encounter at least one such attack incidences of nonmalware attacks spiked by more than 90 in the second quarter of 2016 and have remained at elevated levels ever since ransomware is the fastestgrowing malware across all industries and instances grew by 50 over the year locky is the most used variety used in one out of every four ransomware attacks other popular families include crypto wall  crypt xxx bitman  tesla crypt and onion or ctb locker in march 2016 carbon black discovered power ware a nonmalware ransomware power ware uses microsoft power shell to avoid dropping detectable malware onto the disk the technique however is not limited to ransomware the alleged hack against the democratic national committee dnc earlier this year notes carbon black was reported to have leveraged both power shell and windows management instrumentation wmi in order for attackers to move laterally and remain undetected security week talked to ben johnson cofounder and chief security strategist at carbon black to see how nonmalware attacks operate and how they can be detected and prevented nonmalware attacks have been around for a few years but have really picked up steam this year johnson said its the bad guys living off the land making use of applications that are part of and trusted by the operating system in order to go undetected a typical attack scenario could include a phishing email with an attached microsoft office document the document would contain a macro if the user can be lured into running the macro then from system memory that macro could issue instructions to a variety of system apps the most commonly used are power shell and wmi but it could be any such as ftp that can script and copy and perform other basic functions the point said johnson is the whole kill chain can be conducted without installing anything or dropping any binary to disk when we talk about nonmalware leveraging builtin tools like power shell or ftp or remote desktop the attack is using something that sys admins would normally use anyway most defenses are looking for known malware or new and strange binaries they tend to just assume that if its a trusted os utility it must be ok  im just going to let it run im not even going to watch it thats one of the main reasons why nonmalware attacks are on the rise said johnson detecting nonmalware intrusions requires more than just looking at files it requires monitoring processes the easiest approach but not the be all and end all of it is to look at the relationship and the command line he explained as soon as you can see power shell being used in this case you would say why is ms word spawning power shell you have to look at the context where the more traditional approaches just look at the individual programs that are running a second approach is to look at the content of the command line what usually happens from an attacker he continued is a bunch of arguments get pasted onto the command line and the script itself is usually encoded with say base64 so it just looks like random characters rather than english text if you can recognize unrecognizable text you know its not likely to be good a third approach looks at the execution of the script we like to think of it kind of like an iceberg he explained in a boat instead of looking at just whats above the surface that little piece of the iceberg thats visible you have to be aware of everything thats hidden just below its the same with cyber defense so once power shell starts running you check to see if it is behaving normally is it trying to access a large number of files in a very short space of time or perhaps trying to communicate outside of the network both of these would be considered unusual and should be blocked the key is in establishing what is normal behavior if you set the bar too high then uncommon rather than abnormal will be blocked and business processes will be disturbed if you set it too low then malicious activity can proceed undetected the solution said johnson is a continuous learning process tweaking the system to gain the optimum performance in line with the users individual risk posture on this basis we can chose to allow alert or block but as a rule of thumb the more the user can whitelist processes  and johnson and carbon black are big supporters of whitelisting  the stronger will be the defense as an example suggested johnson if it is known that the only valid use of power shell is a particular script from it that runs at a set time each night to update applications across the system then this can whitelisted and allowed and all other uses of power shell will automatically be blocked in this scenario power ware wouldnt even get out of its macro related reading breaches are more than malware tweet kevin townsend is a senior contributor at security week he has been writing about high tech issues since before the birth of microsoft for the last 15 years he has specialized in information security and has had many thousands of articles published in dozens of different magazines – from the times and the financial times to current and longgone computer magazines previous columns by kevin townsend mocana launches supply chain integrity platform to secure io t ics devices industrial internet consortium develops new io t security maturity model malware activity slows but attacks more sophisticated report new strain of atm jackpotting malware discovered financial services ddo s attacks tied to reaper botnet2018 ics cyber security conference  usa oct 22252018 ics cyber security conference  singapore april 2426register for the 2018 ciso forum at half moon baysponsored links tags endpoint security network security news  industry 