configuring share point my calendar web parts to synchronize with exchange email accounts share point 2010summary learn about various collaboration features in microsoft share point server 2010 such as how to configure use and extend the my calendar web part to synchronize with your corporate microsoft exchange email account wrox share point books last modified march 09 2015applies to business connectivity services  exchange server  open xml  share point designer 2010  share point foundation 2010  share point online  share point server 2010  visual studio author johnny harbieh editors wrox tech editors for share point 2010 articles contents introduction to collaborative features in share point server 2010calendars in share point 2010adding and configuring the my calendar web part extending the my calendar web part about the author additional resources introduction to collaborative features in share point server 2010share point 2010 combines features and tools that enable people and processes to work better together team members who are working together on the same project can work and collaborate more efficiently table 1 lists some of the collaboration features in share point table 1 collaboration features in share point server 2010feature description blogs use blog sites to share knowledge and provide guidance to team members and internal or external visitors discussions use discussion lists to create discussion threads and reply to team discussions wiki use wiki sites and pages to quickly add and update content team sites use team sites to share and contribute content calendars use a calendar list to manage corporate or team events tasks use a task list to manage project tasks workspaces use workspaces to collaborate offline or online the next section discusses how to use calendars on collaborative share point sites calendars in share point 2010the list of collaboration features in the preceding section is only a subset this section discusses how to use one of the features on that list calendars share point foundation 2010 provides the calendars in share point 2010 calendars are central to most collaborative and departmental team sites imagine that you are involved in a project because the project manager must keep track of meetings and deadlines he or she must have access to calendars task lists and so on the project manager can create a share point site and add a calendar the calendar can be a team calendar that is stored in share point or a calendar that is stored in exchange but is displayed in share point the following are some examples of how teams use calendars on share point sites today example 1 share point calendar list create and manage a calendar list in share point team members can view or edit events on the calendar list depending on their permissions you can synchronize calendar lists in share point 2010 with an outlook 2010 calendar it is a twoway synchronization which means that when you add or modify events in share point or in microsoft outlook 2010 those events appear in both applications after the next synchronization you can also display multiple calendar lists together on the same page you can display up to ten calendars each with a different color on the same page for example you can display two share point calendars together on the same page figure 1 example share point calendars in overlay mode example 2 my calendar web part on a share point page add a my calendar web part to a share point page to display calendar events that are stored on the computer that is running microsoft exchange server individual team members can use the my calendar web part to display their own calendars on their own sites or you can use the web part to display a shared team calendar for more information see adding and configuring the my calendar web part example 3 custom calendar web part on a share point page add a custom calendar web part to a share point page by extending the my calendar web part and adding custom code example 4 page viewer web part that displays a shared exchange calendar configure a page viewer web part to display a shared exchange calendar on a share point page the page viewer web part is basically an html iframe element that can view a webpage such as an microsoft outlook web app calendar page as shown in figure 2 figure 2 example page viewer web part showing a calendar in outlook web app table 2 lists the web part properties that are required to display the exchange calendar table 2 page viewer web part properties property description display type what you want to showselect web page the default settinglink basic url example httpsoutlookwroxcomowa advanced url examplehttpsoutlookwroxcomowauserwroxcomcmdcontentsmodulecalendar this example shows how to extend the url to point to a specific account calendar module for more information about how to use outlook web app web parts or for more information about url formats see additional resources example 5 group calendars use group calendars in share point 2010 to add resources to a single calendar group calendars are a great addition to share point they are offered as part of the group worksite template and enable project managers to add conference rooms book resources or even add people as shown in figure 3 figure 3 example group calendar these are only some of the many ways that you can use the calendarspecific features in share point the next section examines how to add and configure the my calendar web part to display it on a share point page adding and configuring the my calendar web part earlier you learned that the my calendar web part is available in share point server 2010 standard edition or share point server 2010 enterprise edition but not available in share point foundation 2010 the my calendar web part and several other web parts is available as part of the outlook web app web parts as shown in figure 4 figure 4 my calendar web part the my calendar web part is stored in the web part gallery on the site collection level in a file that is named owacalendardwp to access the web part gallery follow these steps click site actions and then click site settings in the galleries section choose web parts to display the list of web parts available in your share point site collection web part gallery see figure 5 figure 5 my calendar web part in the site collection web part gallery you can view the web part in the gallery or you can export its xml definition file to export the web part follow these steps select the web part that is named owacalendardwp in the gallery in the documents tab of the ribbon click view properties click the name and if you are prompted save the file to your desktop the name of the web part is linked to its xml definition file and its file name extension is dwp if you open the definition file you see the following xml xmlxml version10 encodingutf8 web part xmlnshttpschemasmicrosoftcomweb partv2 assemblymicrosoft share point portal version14000 cultureneutral public key token71e9bce111e9429cassembly type namemicrosoft share point portal web controls owacalendar parttype name titlemy calendartitle descriptiondisplays your calendar using outlook web access for microsoft exchange server 2003 or laterdescription part image largelayoutsimageswppersgifpart image large web partthe preceding xml definition file is a my calendar web part that is not configured you can add this web part to your site configure it and then export it if you do this notice that share point adds more configuration elements to it new web parts built for share point 2010 have a webpart file name extension instead of a dwp file name extension you can open files that have a dwp file name extension only because of backward compatibility table 3 lists the web part main xml elements table 3 owa calendar definition file main elements element descriptionweb partthe root element of a web part definition file it encapsulates the rest of the definitionassemblythis is the dll file or assembly that contains the actual compiled code of the web part this dll file is loaded into memory by the runtime this assembly has other namespaces and classestype namethis element is what specifies the actual class or implementation of the web part in this case it is the owacalendar part class to add and configure the my calendar web part follow these steps click site actions and then click edit page on the ribbon select the insert tab in page tools click the add a web part link in the middle of the web part zone under the categories list box select the outlook web app category and choose my calendar from the web parts list that is next to it as shown in figure 6 figure 6 adding my calendar web part to a share point page click add to add the web part to the web parts pane on the page after the web part is added to the web parts area on the page you can configure it to configure the web part to display your exchange calendar follow these steps click the open the tool pane link that is displayed in the middle of the web part look at the web part properties in mail configuration do the following type the mail server information mail server information is your outlook web app endpoint for example your url might be httpsoutlookwroxcomowa type the mailbox information the email account can be yours or a shared account but it must be a valid corporate email account such as accountwroxcom select a daily or weekly view of your calendar and then click ok figure 7 my calendar web part properties if you are logged on to your network you should be able to see your calendar without having to sign in again after you perform the preceding steps figure 8 my calendar web part by default the my calendar web part does not render in full you can update the appearance of the web part by increasing the value of its height and width properties the mailbox information is optional if you are using the web part to view your own calendar the my calendar web part can translate your credentials including your email account and pass that information on to your corporate exchange server the my calendar web part is now ready to use it is synchronized with your outlook calendar and you can display different calendar views or create or delete an appointment as shown in figure 9 figure 9 my calendar web part toolbar if you export this web part notice that share point adds several new elements to the web part definition file the following example shows an exported web part definition file that has the width element and the height element in addition to the outlook web app server root owaserver address root xmlnsurnschemasmicrosoftcomowapart element and the email address  mailbox name xmlnsurnschemasmicrosoftcomowapart element that is used during the configuration xmlxml version10 encodingutf8 web part xmlnsxsihttpwwww3org2001xmlschemainstance xmlnsxsdhttpwwww3org2001xmlschema xmlnshttpschemasmicrosoftcomweb partv2 titlemy calendartitle frame typedefaultframe type descriptiondisplays your calendar using outlook web app for microsoft exchange server 2003 or laterdescription is includedtrueis included zone idleftzone id part order0part order frame statenormalframe state height700pxheight width700pxwidth allow removetrueallow remove allow zone changetrueallow zone change allow minimizetrueallow minimize allow connecttrueallow connect allow edittrueallow edit allow hidetrueallow hide is visibletrueis visible detail linkhttpsoutlookwroxcomowadetail link help link  help modemodelesshelp mode dirdefaultdir part image small  missing assemblycannot import this web partmissing assembly part image largelayoutsimageswppersgifpart image large is included filter  assemblymicrosoft share point portal version14000 cultureneutral public key token71e9bce111e9429cassembly type namemicrosoft share point portal web controls owacalendar parttype name exchange autodiscovery initialized xmlnsurnschemasmicrosoftcomowapart trueexchange autodiscovery initialized owaserver address root xmlnsurnschemasmicrosoftcomowapart httpsoutlookwroxcomowaowaserver address root mailbox name xmlnsurnschemasmicrosoftcomowapart addresswroxcommailbox name view name xmlnsurnschemasmicrosoftcomowapartdailyview name web partyou can modify these settings and reimport the web part to the web part gallery if you want to share your configuration and enable other people to use your web part the next section explains how to extend the basic functionality of the my calendar web part extending the my calendar web part to extend the base functionality of the my calendar web part you must have access to visual studio 2010 to create custom code that can be deployed to your share point site this section shows how to create a custom web part that inherits from the owacalendar part class this class is part of the microsoft share point web controls namespace and can be found in the microsoft share point portaldll assembly to create a custom web part class follow these steps open visual studio 2010 as an administrator and create an empty share point 2010 project name the project company my custom calendar part and then click ok figure 10 custom my calendar web part share point 2010 project click the deploy as a farm solution option and then click finish figure 11 choose farm solution rightclick your project name in solution explorer click add and then click new item choose the web part item type in the name field type my calendar web part and then click add as shown in figure 12 figure 12 create web part share point project item add microsoft share point portaldll reference to your project if your development computer is also your share point server browse to the cprogram filescommon filesmicrosoft sharedweb server extensions14isapi folder and select the assembly if not copy it from your share point server and place it on your file system in the my calendar web part code file replace the base class name web part with owacalendar part add the following using statement at the top of your my calendar web partcs file cusing microsoft share point portal web controlsthe using statement enables the visual studio compiler and the runtime to resolve the owacalendar part class replace the create child controls method and its contents with the following code example which shows a simple way that you can start to override some of the public members in the owacalendar part class in particular the code example preconfigures the web part so that you and your users don’t have to configure it every time that you add it to a share point page cprotected override void create child controls    todo add your custom code here example overrides the exchange owa endpointthis  owaserver address root  httpsoutlookwroxcomowa   by default the calendar is the folder this web part is configured to show this exchange folder name  calendar there are two view types you can use here the daily view is the default use weekly insteadthis  view name  weekly   the base part provides the loggedon user email account by default this mailbox name  accountwroxcom you must rename the web part definition file because the assembly used is microsoft share point portal and when share point tries to load web parts from that assembly it requires them to have a definition file that has a dwp file name instead of a webpart file name extension in addition the dwp file requires certain xml elements for share point to verify the schema rightclick the webpart file my calendar web partwebpart and rename it my calendar web partdwp open the my calendar web partdwp file and replace its contents with the following code xmlxml version10 encodingutf8 web part xmlnshttpschemasmicrosoftcomweb partv2 assemblycompany my custom calendar part share point project assembly full nameassembly type namecompany my custom calendar part my calendar web part my calendar web part share point project assembly full nametype name titlemy calendar web parttitle descriptionmy web partdescription part image largelayoutsimageswppersgifpart image large web partyou must replace the contents of the dwp file to ensure that share point loads the correct web part definition file that contains the web part v2 schema information because the functionality in the web part relies on the share point portal namespace doubleclick the elementsxml file and replace its contents with the following code notice the dwp file name extension on the web part file replacing the original content ensures that you have the correct values in the path attribute of the file element as well as in the url another option is to take what you must have and replace only those values in the file that you have xmlxml version10 encodingutf8 elements xmlnshttpschemasmicrosoftcomsharepoint  module namemy calendar web part list113 urlcatalogswp file pathmy calendar web partmy calendar web partdwp urlmy calendar web partdwp typeghostable in library property namegroup valuecustom  file module elementscheck your work your class solution and files should match those shown in figure 13 figure 13 custom my calendar web part solution save all your work and then press f5 to start the deployment visual studio 2010 connects to your share point site and then retracts and deploys your solution if you are prompted to modify the webconfig file to enable debugging click ok and then continue as shown in figure 14 visual studio 2010 opens a new browser window that you can use to navigate to the web part gallery and add your web part as shown in figure 15 figure 14 adding custom my calendar web part figure 15 allow debugging in web config about the author johnny harbieh is a lead consultant who works for avtex solutions llc a leading microsoft partner that optimizes client interactions by using technologies based on the microsoft platform as an experienced information worker consultant johnny focuses on the share point platform and what it brings to his clients his work ranges from strategy briefings planning and architecture to development deployment and support of share pointbased solutions johnny holds several certifications in  net sql server and the portals and collaboration space including mcts and mcitp in share point foundation and server 2010 johnny can be reached at johnny harbiehlivecom or on twitter as jharbieh johnny also keeps a public blog the following were tech editors on microsoft share point 2010 articles from wrox matt ranlett is a sql server mvp who has been a fixture of the atlanta  net developer community for many years a founding member of the atlanta dot net regular guys matt has formed and leads several area user groups despite spending dozens of hours after work on local and national community activities such as the share point 1 2 3 series organizing three atlanta code camps working on the ineta board of directors as the vice president of technology and appearing in several podcasts such as  net rocks and the asp net podcast matt recently found the time to get married to a wonderful woman named kim whom he helps to raise three monstrous dogs matt currently works as a senior consultant with intellinet and is part of the team committed to helping people succeed by delivering innovative solutions that create business value jake dan attis when it comes to patterns practices and governance with respect to share point development look no further than jake dan attis a transplant to the atlanta area from moncton canada dan has a degree in applied mathematics but is 100 hardcore share point developer you can usually find dan attending speaking at and organizing community events in the atlanta area including code camps share point saturday and the atlanta share point user group when hes not working in visual studio dan enjoys spending time with his daughter lily watching hockey and football and sampling beers of the world kevin dostalek has over 15 years of experience in the it industry and over 10 years managing large it projects and it personnel he has led projects for companies of all sizes and has participated in various roles including developer architect business analyst technical lead development manager project manager program manager and mentorcoach in addition to these roles kevin also managed a solution delivery department as a vice president for a midsized ms gold partner from 2005 through 2008 and later also served as a vice president of innovation and education in early 2010 kevin formed kick studios as a company providing consulting development and training services in the specialized areas of share point and social computing since then he has also appeared as a speaker at numerous user group summit and conference type events across the country you can find out more about kevin on his blog the kickboard larry riemann has over 17 years of experience architecting and creating business applications for some of the world’s largest companies larry is an independent consultant who owns indigo integrations and does share point consulting exclusively through share point911 he is an author writes articles for publication and occasionally speaks at conferences for the last several years he has been focused on share point creating and extending functionality where share point leaves off in addition to working with share point larry is an accomplished  net architect and has extensive expertise in systems integration enterprise architecture and high availability solutions you can find him on his blog sundararajan narasiman is a technical architect with content management  portals group of cognizant technology solutions chennai with more than 10 years of industry experience sundararajan is primarily into the architecture  technology consulting on share point 2010 server stack and mainstream  net 35 developments he has passion for programming and also has interest for extreme programming  tdd additional resources for more information about the topics concepts and features in this article see the following resources work with multiple exchange and share point calendars in one share point calendar working with outlook web access web parts outlook web application in exchange 2010using outlook web app web parts configure windows integrated authentication for exchange outlook web access use group calendars in share point 2010sandboxed solutions overview share point 2010 feature comparison chart setting up your development environment for share point 2010owacalendar part web part class share point developer center 