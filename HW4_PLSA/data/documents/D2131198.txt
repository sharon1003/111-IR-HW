find out why an ad account keeps locking out in an organisation where you may have hundreds or thousands of ad accounts it will not be unusual to come across incidents where user’s accounts are unexpectedly locked out this is where the microsoft account lockout and management tools will come in handy to help us figure out i which device caused the account lockout and ii the current lock out state of a given user account looking up the current account state after downloading and extracting the microsoft account lockout and management tools simply run the lockout statusexe as an appropriately privileged user such as your domain admin account select file — select target…enter the target user’s username and the domain to lookup now you will see the account status across all domain controllers the first column will give you the domain controller names hidden in the example below the user state will tell you whether the account is locked or not bad pwd count tells you how many times the password was entered incorrectly – this will not tell you how many times it was entered incorrectly beyond the account lockout threshold for example if your group policy states a maximum of 5 incorrect passwords before a lockout then the bad pwd count will not be a number above 5 last bad pwd will tell you the date and time of the last attempt this will not update after the account has been locked out pwd last set is self explanatory lockout time will be the same as the last bad pwd if the account is already locked out orig lock will tell you which domain controller processed the account lockout all domain controllers will replicate the account lockout status anyway but the orig lock will be the initial dc that processed the logon request below is an example of what a locked out account looks like the domain controller names are obscured the orig lock was set to the third dc in the list i believe the reason why bad pwd count is listed twice is because even though the third dc in the list processed the original logon request – it still needs to reference the pdc emulator for example assume dc1 holds the pdc emulator role now imagine you log in to a desktop pc which picks dc2 as the domain controller to authenticate against dc2 will check with the pdc emulator dc1 before it allows the user to logon hence why the pdc emulator and the original requester will register a bad password count finding out which machine caused the account to be locked out this is where eventcomb mtexe comes in handy again fire it up as an appropriately privileged account or domain admin otherwise the tool will not be able to view the security logs on the domain controllers fill in the domain name and right click the empty white box below and get dcs in domain click the searches menu and select built in searches – account lockouts the event ids filled by default cover older versions of windows event id 4740 covers server 2008 r2 and above so enter that now select a date range by going to the options – set date range menu now click search in the main window when the search has finished you will get an explorer window pop up with some log files temp directory which you can change in options – set output directorythe log file will be easy to read and will look like this text4740audit successmicrosoftwindowssecurityauditingsat jul 25 112542 2015no usera user account was locked out subject security id s1518 account name dc01 account domain network logon id 0x3e7 account that was locked out security id s1521somelongsidhere account name mtunc additional information caller computer name desktoppc123 textthe long security id sid is the user’s unique security identifier account name is self explanatory and is the user’s ad account name the caller computer name is the interesting bit which will tell us which device locked the account out in this case it’s a machine called desktoppc123 which can now be investigated it’s possible you may find strange caller computer names – for example you may find your exchange cas server listed this is indicative of incorrect credentials on a user’s mobile devicelaptoptabletetc this can be investigated further by reviewing the iis logs on the exchange server automation it probably wouldn’t be too difficult to script the above so that the servicedesk receives an email or summary of account lockouts in a given period it would even be useful for your securitysysadmins to look through to see if there is any suspicious activity going on if i have time to make such a script then you’ll see it here first share this email linked in whats app twitter reddit skype google telegram print more like this loading related posts archiving a user’s mailbox on office 365where are those group policies can you move from an office 365 enterprise plan to a midsize business plan disable remote power shell for office365 users twofactor authentication with black berry 10july 25 2015 mikail account lockout ad event id 4740 eventcombmt lockoutstatus microsoft account lockout and management tools