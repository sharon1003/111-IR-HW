generate random letters with power shell★ ★ ★ ★ ★★ ★ ★ ★★ ★ ★★ ★★the scripting guys november 5 2015 6share 0 0summary ed wilson microsoft scripting guy talks about generating random letters with windows power shell hey scripting guy i need to generate a string of random letters these letters need to be five characters long and they should be either upper case or lower case i do not need any numbers or special characters in fact my strings should not contain any special characters—only upper case and lower case letters i have spent several days on this and it is not working i am not looking for a random password generator i have a rather special application for this can you help me—bghello bgmicrosoft scripting guy ed wilson is here one of the things that i love and some people seem to really hate about windows power shell is the “oneliner i mean i can do a lot of good work in a single line of code but the amount of work that goes into creating a oneliner can be considerable then again sometimes a oneliner seems to spring from nothingness into fullblown oneliner mode it is like the way kudzu grows in the deep southern portion of the united states it starts small and then keeps growing and growing and growing that is the way that most of my oneliners develop—organically where i keep piling things on top as required five random letters in one line i can create a five random letter word with a single line of windows power shell but it takes advantage of several very interesting things lets take a look at the parts of my oneliner and i will show the completed oneliner at the end of the post first of all i am going to assume that i can use the ascii table and that i do not need unicode characters i can use the same technique with unicode if required in the ascii table the numbers 6590 represent the upper case letters of the alphabet the numbers 97–122 represent the lower case alphabet i can use the range operator to create a range of numbers but it does not seem to like gaps in the range so i am going to create two arrays of numbers and then simply add them together to add together arrays i use the  operator here is my range of numbers that go 65–90 and 97122 6590  97122because i now have a single array of numbers with my range i can pipe the output from that range to the getrandom cmdlet and tell it to select five numbers for me the command uses the count parameter getrandom count 5because the getrandom cmdlet loves pipelined input all i need to do is add a pipe character after my array of numbers and before getrandom 6590  97122  getrandom count 5i can test that the command works by highlighting the code in the ise and running only the selected code this is shown in the following image create a letter from a number to create a letter from a number all i need to do is to cast the number as a char when i do that it will return the letter associated with the ascii coded numeric value ps c char65anow all i need to do is to accept the pipelined input from the getrandom portion of the code but i cannot simply place char following the pipeline character because char will not accept pipelined input the  works because it represents the current number in the pipeline it is the char part that has the issue luckily windows power shell can handle that by using the foreachobject cmdlet it will now take each object that comes across the pipeline and do whatever i put into my script block the  delineates the script block because i am writing a oneliner i do not want to go to the trouble of spelling out foreachobject so i can use the  alias instead note using the  alias is a bit difficult for some people to grasp because it seems to have no basis in reality i mean gps can be related to getprocess but  what is up with that well if you think of the  o  portion of  as the object in the pipeline the    portion of  as the pipeline character and then back to  o  as the object you can sort of see the object going across the pipeline…maybe…if you hold your head tilted to the right anyway that is how i remembered it when i was learning windows power shell now i have the following portion of the code 6590  97122  getrandom count 5    charhere is the associated output when i run only that selected portion of the oneliner put it together i need to put the five letters back together how do i do that well i need to join them so i use the –join operator and put the rest of the code in a pair of parenthesesjoin  6590  97122  getrandom count 5    charnow when i run the code i get a single line of five random letters that is made up of upper and lower case letters of the alphabet bg that is all there is to creating a random string of letters join me tomorrow when i will talk about more way cool stuff i invite you to follow me on twitter and facebook if you have any questions send email to me at scriptermicrosoftcom or post your questions on the official scripting guys forum see you tomorrow until then peace ed wilson microsoft scripting guy tags ascii getrandom getting started scripting guy strings windows power shell 