perl and cgi tutorial advertisements previous page next page what is cgi  the common gateway interface or cgi is a set of standards that define how information is exchanged between the web server and a custom script the cgi specs are currently maintained by the ncsa and ncsa defines cgi is as follows −the common gateway interface or cgi is a standard for external gateway programs to interface with information servers such as http servers the current version is cgi11 and cgi12 is under progress web browsing to understand the concept of cgi lets see what happens when we click a hyper link to browse a particular web page or url your browser contacts the http web server and demand for the url ie filename web server will parse the url and will look for the filename in if it finds that file then sends back to the browser otherwise sends an error message indicating that you have requested a wrong file web browser takes response from web server and displays either the received file or error message however it is possible to set up the http server so that whenever a file in a certain directory is requested that file is not sent back instead it is executed as a program and whatever that program outputs is sent back for your browser to display this function is called the common gateway interface or cgi and the programs are called cgi scripts these cgi programs can be a perl script shell script c or c program etc cgi architecture diagram web server support  configuration before you proceed with cgi programming make sure that your web server supports cgi and it is configured to handle cgi programs all the cgi programs be executed by the http server are kept in a preconfigured directory this directory is called cgi directory and by convention it is named as cgibin by convention perl cgi files will have extention as cgi first cgi programusrbinperlprint contenttypetexthtmlrnrnprint htmlprint headprint titlehello word  first cgi programtitleprint headprint bodyprint h2hello word this is my first cgi programh2print bodyprint html1output hello word this is my first cgi program http header the line contenttypetexthtmlrnrn is part of http header which is sent to the browser to understand the content all the http header will be in the following form http field name field content for example contenttype texthtmlrnrn there are few other important http headers which you will use frequently in your cgi programming s no header  description1contenttype string a mime string defining the format of the file being returned example is contenttypetexthtml2expires date string the date the information becomes invalid this should be used by the browser to decide when a page needs to be refreshed a valid date string should be in the format 01 jan 1998 120000 gmt3location url string the url that should be returned instead of the url requested you can use this filed to redirect a request to any file4lastmodified string the date of last modification of the resource5contentlength string the length in bytes of the data being returned the browser uses this value to report the estimated download time for a file6setcookie string set the cookie passed through the string cgi environment variables all the cgi program will have access to the following environment variables these variables play an important role while writing any cgi program s no variable name  description1contenttypethe data type of the content used when the client is sending attached content to the server for example file upload etc2contentlengththe length of the query information its available only for post requests3httpcookiereturn the set cookies in the form of key  value pair4httpuseragentthe useragent requestheader field contains information about the user agent originating the request its name of the web browser5pathinfothe path for the cgi script6querystringthe urlencoded information that is sent with get method request7remoteaddrthe ip address of the remote host making the request this can be useful for logging or for authentication purpose8remotehostthe fully qualified name of the host making the request if this information is not available then remoteaddr can be used to get ir address9requestmethodthe method used to make the request the most common methods are get and post10scriptfilenamethe full path to the cgi script11scriptnamethe name of the cgi script12servernamethe servers hostname or ip address13serversoftwarethe name and version of the software the server is runningusrbinperlprint contenttype texthtmlnnprint font size1environmentfontnforeach  sort keys  env print bb env brn1output environment contextdocumentroot contextprefix documentroot gatewayinterface geoipaddr geoipcontinentcode geoipcountrycode geoipcountryname httpaccept httpacceptencoding httpacceptlanguage httpcookie httphost httpupgradeinsecurerequests httpuseragent httpvia httpxforwardedfor httpxforwardedproto httpxhost path querystring remoteaddr remoteport requestmethod requestscheme requesturi scriptfilename scriptname scripturi scripturl serveraddr serveradmin servername serverport serverprotocol serversignature serversoftware uniqueid how to raise a file download dialog box  sometime it is desired that you want to give option where a use will click a link and it will pop up a file download dialogue box to the user in stead of displaying actual content this is very easy and will be achived through http header this http header will be different from the header mentioned in previous section for exampleif you want make a file name file downloadable from a given link then its syntax will be as followsusrbinperl  http header print  contenttype applicationoctetstream namefile namern print  contentdisposition attachment filenamefile namernn  actual file content will go hear open  file file name  while read file buffer 100   print buffer get and post methods you must have come across many situations when you need to pass some information from your browser to web server and ultimately to your cgi program most frequently browser uses two methods two pass this information to web server these methods are get method and post method passing information using get method the get method sends the encoded user information appended to the page request the page and the encoded information are separated by the  character as follows − httpwwwtestcomcgibinhellocgikey1value1key2value2the get method is the defualt method to pass information from browser to web server and it produces a long string that appears in your browsers locationbox never use the get method if you have password or other sensitive information to pass to the server the get method has size limtation only 1024 characters can be in a request string this information is passed using querystring header and will be accessible in your cgi program through querystring environment variable you can pass information by simply concatenating key and value pairs along with any url or you can use html form tags to pass information using get method simple url example  get method here is a simple url which will pass two values to hellogetcgi program using get method below is hellogetcgi script to handle input given by web browserusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq get buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valuefirstname  form  firstname lastname  form  lastname print contenttypetexthtmlrnrnprint htmlprint headprint titlehello  second cgi programtitleprint headprint bodyprint h2hello firstname lastname  second cgi programh2print bodyprint html1output hello zara ali  simple form example get method here is a simple example which passes two values using html form and submit button we are going to use same cgi script hellogetcgi to handle this inputform action  cgibinhellogetcgi method  get first name input type  text name  firstname  brlast name input type  text name  lastname input type  submit value  submit formhere is the actual output of the above form you enter first and last name and then click submit button to see the result first name last name passing information using post method a generally more reliable method of passing information to a cgi program is the post method this packages the information in exactly the same way as get methods but instead of sending it as a text string after a  in the url it sends it as a separate message this message comes into the cgi script in the form of the standard input below is hellopostcgi script to handle input given by web browser this script will handle get as well as post methodusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq post read  stdin buffer env  contentlength  else buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valuefirstname  form  firstname lastname  form  lastname print contenttypetexthtmlrnrnprint htmlprint headprint titlehello  second cgi programtitleprint headprint bodyprint h2hello firstname lastname  second cgi programh2print bodyprint html1let us take again same example as above which passes two values using html form and submit button we are going to use cgi script hellopostcgi to handle this inputform action  cgibinhellopostcgi methodpost first name input typetext namefirstname br last name input typetext namelastname input typesubmit valuesubmit formhere is the actual output of the above form you enter first and last name and then click submit button to see the result first name last name passing checkbox data to cgi program checkboxes are used when more than one option is required to be selected here is example html code for a form with two checkboxesform action  cgibincheckboxcgi method  post target  blank input type  checkbox name  maths value  on  maths input type  checkbox name  physics value  on  physics input type  submit value  select subject formthe result of this code is the following form maths physics below is checkboxcgi script to handle input given by web browser for radio buttonusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq post read  stdin buffer env  contentlength  else buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valueif  form  maths  mathsflag  on else mathsflag  offif  form  physics  physicsflag  on else physicsflag  offprint contenttypetexthtmlrnrnprint htmlprint headprint titlecheckbox  third cgi programtitleprint headprint bodyprint h2 check box maths is  mathsflagh2print h2 check box physics is  physicsflagh2print bodyprint html1passing radio button data to cgi program radio buttons are used when only one option is required to be selected here is example html code for a form with two radio button −form action  cgibinradiobuttoncgi method  post target  blank input type  radio name  subject value  maths  maths input type  radio name  subject value  physics  physics input type  submit value  select subject formthe result of this code is the following form −maths physics below is radiobuttoncgi script to handle input given by web browser for radio buttonusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq post read  stdin buffer env  contentlength  else buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valuesubject  form  subject print contenttypetexthtmlrnrnprint htmlprint headprint titleradio  fourth cgi programtitleprint headprint bodyprint h2 selected subject is subjecth2print bodyprint html1passing text area data to cgi program textarea element is used when multiline text has to be passed to the cgi program here is example html code for a form with a textarea box −form action  cgibintextareacgi method  post target  blank textarea name  textcontent cols  40 rows  4 type your text here textareainput type  submit value  submit formthe result of this code is the following form −type your text here below is textareacgi script to handle input given by web browserusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq post read  stdin buffer env  contentlength  else buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valuetextcontent  form  textcontent print contenttypetexthtmlrnrnprint htmlprint headprint titletext area  fifth cgi programtitleprint headprint bodyprint h2 entered text content is textcontenth2print bodyprint html1passing drop down box data to cgi program drop down box is used when we have many options available but only one or two will be selected here is example html code for a form with one drop down boxform action  cgibindropdowncgi method  post target  blank select name  dropdown option value  maths selected  maths optionoption value  physics  physics optionselectinput type  submit value  submit formthe result of this code is the following form −below is dropdowncgi script to handle input given by web browserusrbinperllocal  buffer pairs pair name value  form  read in textenv  requestmethod   tr  a  z  a  z if  env  requestmethod  eq post read  stdin buffer env  contentlength  else buffer  env  querystring  split information into namevalue pairspairs  split   buffer foreach pair  pairs   name value  split   pair value  tr   value  s   pack  c hex  1  egform  name   valuesubject  form  dropdown print contenttypetexthtmlrnrnprint htmlprint headprint titledropdown box  sixth cgi programtitleprint headprint bodyprint h2 selected subject is subjecth2print bodyprint html1using cookies in cgihttp protocol is a stateless protocol but for a commercial website it is required to maintain session information among different pages for example one user registration ends after completing many pages but how to maintain users session information across all the web pages in many situations using cookies is the most efficient method of remembering and tracking preferences purchases commissions and other information required for better visitor experience or site statistics how it works your server sends some data to the visitors browser in the form of a cookie the browser may accept the cookie if it does it is stored as a plain text record on the visitors hard drive now when the visitor arrives at another page on your site the cookie is available for retrieval once retrieved your server knowsremembers what was stored cookies are a plain text data record of 5 variablelength fields −expires − the date the cookie will expire if this is blank the cookie will expire when the visitor quits the browser domain − the domain name of your site path − the path to the directory or web page that set the cookie this may be blank if you want to retrieve the cookie from any directory or page secure − if this field contains the word secure then the cookie may only be retrieved with a secure server if this field is blank no such restriction exists namevalue − cookies are set and retrviewed in the form of key and value pairs setting up cookies this is very easy to send cookies to browser these cookies will be sent along with http header assuming you want to set user id and password as cookies so it will be done as follows −usrbinperlprint setcookie user idxyznprint setcookie passwordxyz123nprint setcookie expirestuesday 31dec2007 231240 gmt n  print  set  cookie domain  www tutorialspoint com n  print  set  cookie path  perl n  print  content  type text  htmlrnrn   rest of the html content from this example you must have understood how to set cookies we use setcookie http header to set cookies here it is optional to set cookies attributes like expires domain and path it is notable that cookies are set before sending magic line contenttypetexthtmlrnrn retrieving cookies this is very easy to retrieve all the set cookies cookies are stored in cgi environment variable httpcookie and they will have following formkey1value1key2value2key3value3 here is an example of how to retrieving cookiesusrbinperlrcvdcookies  env  httpcookie cookies  split  rcvdcookiesforeach cookie  cookies   key val  split   cookie   splits on the first key  s  s  val  s  s  key  s  s   val  s  s   if  key eq user id userid  val elsif  key eq password password  valprint user id  useridnprint password  passwordnthis will produce following result user id  xyzpassword  xyz123cgi modules and libraries you will find many builtin modules over the internet which provide you direct functions to use in your cgi program following are the important once cgi module berkeley cgilibpl previous page print next page advertisements 