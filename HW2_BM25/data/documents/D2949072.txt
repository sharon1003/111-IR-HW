rgb led tutorial using an arduino rgbltechnology kits by oomlout follow56503633549posted jul 17 2009leds are great but with any project there comes a point where flashing is simply not enough for these cases an rgb red green blue led is the answer with an rgb led youll be able to produce any colour glow your heart desires at first using an rgb led seems quite complex but it quite quickly becomes clear that its no more difficult than controlling one of their single colour counter parts what follows is a quick guide to get you started controlling an rgb led first with wires then with an arduino microcontroller if youd like to jump ahead to any part heres your chance step 1 the parts step 2 testing step 3 arduino controlled example circuit step 4 digital control of colour step 5 analog control of colour shamless plug interested in getting a few rgb leds to play around with and in the uk a component bundle can be bought at our online store oomloutcouk add tip ask question step 1 parts only a few parts are required rgb led common anodea common anode rgb led is nothing more complicated than three one colour leds one red one green and one blue housed in a single package rather than having 6 leads a cathode and anode for each led it has only 4 one cathode for each colour and one common anode see the schematic diagram belowa common anode rgb led is the most popular type it is most commonly found in either a 5mm bulb size or as a 5mm pirahna form factor current limiting resistors 270 ohm redpurplebrownmost leds are designed to work with a voltage between 15v and 3v as most microcontrollers including the arduino operate on 5 volts a current limiting resistor is required consult your leds datasheet for maximum ratings but we like to use 270 ohm resistors this limits the current to 20m a well within most leds and microcontroller ratings arduino microcontroller  breadboard a great open source microcontroller platform for more details visit arduinoccadd tip ask question step 2 testing before we connect our rgb led to our arduino its a good idea to give it a test consult your rgb leds datasheet for its pinout or below are the two most common rgb led form factors and pinouts wire up the test schematic belowplug the rgb led into your breadboard connect a current limiting resistor to each of the three cathodes connect the common anode to 5v 5 voltstest each color by connecting its current limiting resistor to ground gndexperiment with colour mixing a little by powering multiple elements at once a quick video of us testing an rgb ledadd tip ask question step 3 example circuit time to move on to controlling your rgb leds with an arduino for the example code to follow youll need three rgb leds and 9 current limiting resistors avaliable for purchase in the uk from oomloutcouk  wire up the circuit below there are two ways to do this for the more advanced consult the schematic below or for the less advanced you can download a breadboard layout sheet the pdf below print this out and lay it over your breadboard for convenient component placement rgbllayout sheetpdf download add tip ask question step 4 digital arduino code it is possible to control an rgb led digitally this requires 3 digital pins for each led and allows for 7 colours to be displayed red green blue yellow cyan magenta white but dont take our word for it download the code below and get playing to do this simply copy the code below and paste it into a an empty arduino sketch compile and upload the sketch to your arduino board enjoy as your three leds light up red green and blue if you go to the loop  section of the code under example 1 you can see where you change the colors try a few other variations to see how we control each led look at the set color  function next comment out add  to the three lines of example 1 uncomment delete  from in front of every line in the example 2 section of the loop  code upload this to your board and watch as your three leds change colour randomly play around with the code to see how it works and make your own fun color functions a quick video of digital example one and digital example 2 appendix 1 rgbldigitalpde bof rgbl  rgb digital preamblergb led pinsint led digital one   14 15 16 the three digital pins of the first digital led 14  red pin 15  green pin 16  blue pinint led digital two   9 10 11 the three digital pins of the first digital led 14  red pin 15  green pin 16  blue pinint led digital three   3 5 6 the three digital pins of the first digital led 14  red pin 15  green pin 16  blue pinconst boolean on  low define on as low this is because we use a common anode rgb led common pin is connected to 5 voltsconst boolean off  high define off as highpredefined colorsconst boolean red   on off off const boolean green   off on off const boolean blue   off off on const boolean yellow   on on off const boolean cyan   off on on const boolean magenta   on off on const boolean white   on on on const boolean black   off off off an array that stores the predefined colors allows us to later randomly display a colorconst boolean colors   red green blue yellow cyan magenta white black eof rgbl  rgb digital preamblevoid setup   for int i  0 i  3 i  pin mode led digital one i output set the three led pins as outputs pin mode led digital two i output set the three led pins as outputs pin mode led digital three i output set the three led pins as outputs void loop   example  1 set a color set the three leds to any predefined color set color led digital one red set the color of led one set color led digital two green set the color of led two set color led digital three blue set the color of led three exampe  2 go through random colors set the leds to a random color int rand  random 0 sizeof colors  2 get a random number within the range of colors  set color led digital one colors rand set the color of led one to a random color rand  random 0 sizeof colors  2 set the color of led 2 to a random color  set color led digital two colors rand rand  random 0 sizeof colors  2 set the color of led 3 to a random color  set color led digital three colors rand delay 1000  sets an led to any color led  a three element array defining the three color pins led 0  red pin led 1  green pin led 2  blue pin color  a three element boolean array color 0  red value low  on high  off color 1  green value color 2 blue valuevoid set color int led boolean color  for int i  0 i  3 i  digital write led i color i  a version of set color that allows for using const boolean colorsvoid set color int led const boolean color  boolean temp color   color 0 color 1 color 2 set color led temp coloradd tip ask question step 5 analog arduino code now onto the fun stuff controlling an rgb led using the arduinos pwm pulse width modulation pins this lets you create almost any colour your heart desires and better than that fade between colours to do this each led requires 3 pwm pins as the arduino has only 6 pwm pins only two rgb leds can be controlled this way at a time in terms of the code we will use the analog write pin value function for more details visit the code reference on arduinocc  to get playing with the your leds in an analog manner simply copy and paste the code below into an empty arduino sketch compile and upload the sketch to your arduino board example one will start by turning the led magenta you can then play around with the colour to change it to other presets or define your ownnext comment out the example 1 line add uncomment example 2 delete the compile and upload the example to your board now watch as your led turns a whitish green colour change the numbers in the temp color  array to change the displayed colour comment out example 2 add uncomment example 3 delete the compile and upload the program to your board watch as the led fades from red to green to blue to see how this is accompished look to the fade to color  function next get coding and making your own fun colour changing programmes a small video of the test program appendix 1 rgblanalog testbofrgblanalog preamblergb led pinsint led analog one   3 5 6 the three pins of the first analog led 3  red pin 5  green pin 6  blue pin these pins must be pwmint led analog two   9 10 11 the three pins of the second analog led 9  red pin 10  green pin 11  blue pin these pins must be pwmdefined colors different rgb red green blue values for colors to add your own ie fuscia experiment and then add to the listconst byte red   255 0 0 const byte orange   83 4 0 const byte yellow   255 255 0 const byte green   0 255 0 const byte blue   0 0 255 const byte indigo   4 0 19 const byte violet   23 0 22 const byte cyan   0 255 255 const byte magenta   255 0 255 const byte white   255 255 255 const byte black   0 0 0 const byte pink   158 4 79 eofrgblanalog preamblevoid setup   for int i  0 i  3 i  pin mode led analog one i output set the three led pins as outputs pin mode led analog two i output set the three led pins as outputs  set color led analog one black turn off led 1 set color led analog two black turn off led 2void loop   example 1  defined colors set to a known color you can use any of the above defined colors set color led analog one magenta  example 2  any color set the led to any color you like byte temp color   123412 the rgb red gren blue value for a color to display set color led analog one temp color example 3  fading fade the led between two colors this will go from red to green to blue then back to red fade to color led analog one red green 10 fade to color takes 4 parameters led analog one  an array with 3 values defining the red green and blue pins of the led red  this is the start color green  this is the end color 10  the delay in milliseconds between updates determines the fade speed fade to color led analog one green blue 10 fades from green to blue fade to color led analog one blue red 10 fades from blue to red sets the color of the led to any rgb value led  int array of three values defining the leds pins led 0  red pin led 1  green pin led 2  blue pin color  byte array of three values defing an rgb color to display color 0  new red value color 1  new green value color 2  new red valuevoid set color int led byte color  for int i  0 i  3 i  iterate through each of the three pins red green blue analog write led i 255  color i set the analog output value of each pin to the input value ie led 0 red pin to 255 color 0 red input color we use 255  the value because our rgb led is common anode this means a color is full on when we output analog write pin 0 and off when we output analog write pin 255  a version of set color that takes a predefined color neccesary to allow const int predefined colors void set color int led const byte color  byte temp byte   color 0 color 1 color 2 set color led temp byte fades the led from a start color to an end color at fade speed led  int array of three values defining the leds pins led 0  red pin led 1  green pin led 2  blue pin start ccolor  byte array of three values defing the start rgb color start color 0  start red value start color 1  start green value start color 2  start red value end ccolor  byte array of three values defing the finished rgb color end color 0  end red value end color 1  end green value end color 2  end red value fade speed  this is the delay in milliseconds between steps defines the speed of the fade void fade to color int led byte start color byte end color int fade speed  int change red  end color 0  start color 0 the difference in the two colors for the red channel int change green  end color 1  start color 1 the difference in the two colors for the green channel int change blue  end color 2  start color 2 the difference in the two colors for the blue channel int steps  max abs change redmax abs change green abs change blue make the number of change steps the maximum channel change for int i  0  i  steps i  iterate for the channel with the maximum change byte new red  start color 0  i  change red  steps the new red intensity dependant on the start intensity and the change determined above byte new green  start color 1  i  change green  steps the new green intensity byte new blue  start color 2  i  change blue  steps the new blue intensity byte new color   new red new green new blue define an rgb color array for the new color set color led new color set the led to the calculated value delay fade speed delay fade speed milliseconds before going on to the next color  set color led end color the led should be at the end color but set to end color to avoid rounding errors a version of fade to color that takes predefined colors neccesary to allow const int predefined colors void fade to color int led const byte start color const byte end color int fade speed  byte temp byte1   start color 0 start color 1 start color 2 byte temp byte2   end color 0 end color 1 end color 2 fade to color led temp byte1 temp byte2 fade speedadd tip ask question step 6 finished by this point youve mastered controlling an rgb led all thats left is coming up with great ideas on how to use it we have loads of plans for them around oomlout hq and wed love too hear about what you get up to please leave a coment below or send us an email to infooomloutcom with any details add tip ask question share did you make this project share it with usi made itrecommendations you tube subscriber counter with esp8266by bekathwia in technology dotter  huge arduino based dot matrix printerby nikus in arduino feature cam for lathes class273 enrolled add tip ask question post comment we have a be nice policy please be positive and constructive add images post47 comments mousepotato01 11 months ago reply greating i am trying to dive head first into this codeing ok i am an artist i make dioramas and signs with blacklight colors and glow in the dark colors along with silicon molds and sculptures and need this code for this board please i am sorry i am so green to programing still i only started this in january of 2017 and got this far to know what i need and what to get i tried my own but failed at modifing others codes to work with this board please help me out if you can include rgbhcompilation terminatedexit status 1error compiling for board arduinogenuino uno jjinc 4 years ago reply so why do common anodes exist i have yet to find any benefit in them i have common cathode and instead of just 7 colors i can vary the power to each led achieving 767 i think is what it was i think there are 250 some steps on the pwm and then 3 leds the common anode only seems feasible on 7segments and even then i prefer common cathodevolkvanmyn25 1 year ago in reply to jjinc replycommon anode exist because its easier to drive with open collector npn transistors with common cathode you need to drive it with pnp transistor that need high side driver to be able to switch it onjakub k27 1 year ago reply hello i use different rgb led but instead of for example orange i see red and green can i place something on the led or do something different thanks boris p12 2 years ago reply mine is not working eithersomeone please help  garym57 2 years ago reply i am having trouble pasting the code into a blank sketch everything is pasted onto one line i am new to all of this so could some one tell me what i am doing wrongdwhogamer 3 years ago reply im using a 5mm rgb led and its not doing anything sorry for bad picture quality diymasters 2 years ago in reply to dwhogamer reply try this codeint pwma  9int pwmb  10int pwmc  11int ivoid setup  pin mode pwma outputpin mode pwmb outputpin mode pwmc outputserialbegin 9600void loop  fade all channels up and downserialprintln fading all pwm channels up to max for i0 i255 i analog write pwma ianalog write pwmb ianalog write pwmc idelay 5serialprintln all power wm channels at max delay 5serialprintln fading all channels to 0for i255 i0 i analog write pwma ianalog write pwmb ianalog write pwmc idelay 5serialprintln all pwm channels at zero delay 5fadechannel pwmafadechannel pwmbfadechannel pwmcvoid fadechannel int channel serialprintln fading pwm channel to max serialprintln channelfor i0 i255 i analog write channel idelay 5serialprintln pwm channel at max delay 5serialprintln fading down for i255 i0 i analog write channel idelay 5serialprintln pwm channel at 0 delay 5diymasters 2 years ago reply heres the best version of the code i modified it a little to make it fade much fasterint pwma  9int pwmb  10int pwmc  11int ivoid setup  pin mode pwma outputpin mode pwmb outputpin mode pwmc outputserialbegin 9600void loop  fade all channels up and downserialprintln fading all pwm channels up to max for i0 i255 i analog write pwma ianalog write pwmb ianalog write pwmc idelay 5serialprintln all power wm channels at max delay 5serialprintln fading all channels to 0for i255 i0 i analog write pwma ianalog write pwmb ianalog write pwmc idelay 5serialprintln all pwm channels at zero delay 5fadechannel pwmafadechannel pwmbfadechannel pwmcvoid fadechannel int channel serialprintln fading pwm channel to max serialprintln channelfor i0 i255 i analog write channel idelay 5serialprintln pwm channel at max delay 5serialprintln fading down for i255 i0 i analog write channel idelay 5serialprintln pwm channel at 0 delay 5marvin r3 2 years ago reply hi send me this code rgbldigitalthe code have a wrong when i copy send me please  the arduino code ino more comments post comment follow by oomlout download 