creating service broker queues a queue holds incoming messages for a service to simplify processing applications typically create one queue per service instead of using the same queue for multiple services setting the retention option for a queue cause messages to be retained after they are processed because retention reduces application performance specify retention only if the application requires persistent access to the exact messages sent and received for more information about message retention see message retention for applications that do not use internal activation do not specify an activation clause on the queue definition for applications that use internal activation the queue definition includes the name of the stored procedure the maximum number of readers for sql server to start and the name of the database principal to impersonate before starting the stored procedure the name of a queue is not included in the network format of a message queues are schemaowned objects therefore queue names follow sql server naming conventions for more information about naming see naming service broker objects stored procedure activation a queue can be associated with a stored procedure sql server activates the stored procedure when there are messages in the queue to be processed this process of automatic activation allows a service broker application to scale dynamically according to the current processing load on the application each stored procedure activated by service broker runs in a separate thread when a queue specifies a stored procedure service broker starts new instances of the stored procedure as required up to the maximum number of instances specified for the queue an activated stored procedure typically processes one or more messages and returns a response to the service that originated the messages when messages arrive faster than the stored procedure processes messages service broker starts another instance of the stored procedure up to the maximum number defined by the queue an activated stored procedure typically exits when the procedure finds no messages available on the queue for a while using activation stored procedures is a common way to design service broker applications however other designs might better suit the needs of a specific application any application that can run transactsql batches in sql server can send and receive messages messages can be also be processed by any stored procedure regardless of whether the stored procedure is activated by sql server started by sql server agent run by an external application or run interactively from a tool such as sql server management studio or sql server express management studio see also reference create queue transactsqlconcepts conversation architecture queues understanding when activation occurs